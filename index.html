<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Identity Federation Management API</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://www.w3.org/StyleSheets/TR/2016/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version 4f053d00e, updated Tue Aug 10 14:13:32 2021 -0700" name="generator">
  <link href="http://wicg.github.io/WebID" rel="canonical">
  <meta content="6b567cc47becc2598e828ce3f79c66ffd097ed1a" name="document-revision">
<style>
dl.domintro dt {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;

    padding-top: 0.5em;
    padding-bottom: 1em;
}
dl.domintro dt a {
    color: inherit; border-bottom-style: none;
}
dl.domintro dt code {
    font-size: inherit;
}
</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Identity Federation Management API</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="profile-and-date"><span class="content">Draft Community Group Report, <time class="dt-updated" datetime="2021-09-13">13 September 2021</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="http://wicg.github.io/WebID">http://wicg.github.io/WebID</a>
     <dt>Test Suite:
     <dd><a href="https://github.com/web-platform-tests/wpt/blob/master/credential-management/webid.https.html">https://github.com/web-platform-tests/wpt/blob/master/credential-management/webid.https.html</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/WICG/WebID/issues/">GitHub</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:goto@google.com">Sam Goto</a> (<a class="p-org org" href="https://google.com">Google Inc.</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2021 the Contributors to the Identity Federation Management API Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification defines a set of <a data-link-type="dfn" href="#high-level-api" id="ref-for-high-level-api">high-level API</a>s that enables users to continue to use <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider">Identity Provider</a>s to authenticate to <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party">Relying Party</a>s without incurring into <a data-link-type="dfn">unsactioned tracking</a> on the Web. It accomplishes that by exposing the explicit user controls needed to manage the lifecycle of their federated accounts.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li>
     <a href="#use-cases"><span class="secno">2</span> <span class="content">Use Cases</span></a>
     <ol class="toc">
      <li><a href="#use-cases-sign-up"><span class="secno">2.1</span> <span class="content">Sign-up</span></a>
      <li>
       <a href="#use-cases-sign-in"><span class="secno">2.2</span> <span class="content">Sign-in</span></a>
       <ol class="toc">
        <li><a href="#use-cases-auto-sign-in"><span class="secno">2.2.1</span> <span class="content">Auto Sign-in</span></a>
        <li><a href="#use-cases-explicit-sign-in"><span class="secno">2.2.2</span> <span class="content">Explicit Sign-in</span></a>
       </ol>
      <li>
       <a href="#use-cases-sign-out"><span class="secno">2.3</span> <span class="content">Sign-out</span></a>
       <ol class="toc">
        <li><a href="#use-cases-rp-sign-out"><span class="secno">2.3.1</span> <span class="content">RP Sign-out</span></a>
        <li><a href="#use-cases-idp-sign-out"><span class="secno">2.3.2</span> <span class="content">IDP Sign-out</span></a>
       </ol>
      <li>
       <a href="#use-cases-revocation"><span class="secno">2.4</span> <span class="content">Revocation</span></a>
       <ol class="toc">
        <li><a href="#use-cases-idp-revocation"><span class="secno">2.4.1</span> <span class="content">IDP Revocation</span></a>
        <li><a href="#use-cases-rp-revocation"><span class="secno">2.4.2</span> <span class="content">RP Revocation</span></a>
       </ol>
      <li><a href="#Access"><span class="secno">2.5</span> <span class="content">Access</span></a>
     </ol>
    <li><a href="#examples"><span class="secno">3</span> <span class="content">Examples</span></a>
    <li><a href="#terminology"><span class="secno">4</span> <span class="content">Terminology</span></a>
    <li><a href="#lifecycle"><span class="secno">5</span> <span class="content">High Level Design</span></a>
    <li>
     <a href="#idp-api"><span class="secno">6</span> <span class="content">The Identity Provider API</span></a>
     <ol class="toc">
      <li><a href="#well-known"><span class="secno">6.1</span> <span class="content">Discovery</span></a>
      <li><a href="#accounts_endpoint"><span class="secno">6.2</span> <span class="content">Accounts List</span></a>
      <li><a href="#client_id_metadata_endpoint"><span class="secno">6.3</span> <span class="content">Client Metadata</span></a>
      <li><a href="#idtoken_endpoint"><span class="secno">6.4</span> <span class="content">ID Token</span></a>
      <li><a href="#revocation_endpoint"><span class="secno">6.5</span> <span class="content">Revocation</span></a>
      <li><a href="#Sec-WebID-CSR"><span class="secno">6.6</span> <span class="content"><code><span><code>Sec-WebID-CSR</code></span></code></span></a>
     </ol>
    <li>
     <a href="#rp-api"><span class="secno">7</span> <span class="content">The Relying Party API</span></a>
     <ol class="toc">
      <li><a href="#logout_endpoint"><span class="secno">7.1</span> <span class="content">Logout</span></a>
     </ol>
    <li>
     <a href="#API"><span class="secno">8</span> <span class="content">The Browser API</span></a>
     <ol class="toc">
      <li><a href="#state-machine"><span class="secno">8.1</span> <span class="content">The State Machine</span></a>
      <li><a href="#sign-in"><span class="secno">8.2</span> <span class="content">The Sign-in API</span></a>
      <li><a href="#revocation"><span class="secno">8.3</span> <span class="content">The Revocation API</span></a>
      <li>
       <a href="#sign-out"><span class="secno">8.4</span> <span class="content">The Sign-out API</span></a>
       <ol class="toc">
        <li><a href="#rp-sign-out"><span class="secno">8.4.1</span> <span class="content">RP Sign-out</span></a>
        <li><a href="#idp-sign-out"><span class="secno">8.4.2</span> <span class="content">IDP Sign-out</span></a>
       </ol>
      <li>
       <a href="#backwards-compatibility"><span class="secno">8.5</span> <span class="content">Backwards Compatibility</span></a>
       <ol class="toc">
        <li><a href="#Interceptors"><span class="secno">8.5.1</span> <span class="content">Interceptors</span></a>
       </ol>
     </ol>
    <li><a href="#security"><span class="secno">9</span> <span class="content">Security</span></a>
    <li>
     <a href="#privacy"><span class="secno">10</span> <span class="content">Privacy</span></a>
     <ol class="toc">
      <li>
       <a href="#privacy-threat-model"><span class="secno">10.1</span> <span class="content">Privacy Threat Model</span></a>
       <ol class="toc">
        <li><a href="#principals"><span class="secno">10.1.1</span> <span class="content">Principals</span></a>
        <li>
         <a href="#attack-scenarios"><span class="secno">10.1.2</span> <span class="content">Attack Scenarios</span></a>
         <ol class="toc">
          <li>
           <a href="#relying-party-collecting-information"><span class="secno">10.1.2.1</span> <span class="content">Relying Party collecting information</span></a>
           <ol class="toc">
            <li><a href="#-rp1-multiple-relying-parties-correlate-user-information-for-tracking-purposes"><span class="secno">10.1.2.1.1</span> <span class="content">(<span>RP1</span>) Multiple Relying Parties correlate user information for tracking purposes</span></a>
            <li><a href="#-rp2-relying-party-obtains-personal-user-information-from-idp-without-user-consent"><span class="secno">10.1.2.1.2</span> <span class="content">(<span>RP2</span>) Relying Party obtains personal user information from IDP without user consent</span></a>
            <li><a href="#-rp3-relying-party-uses-user-information-for-purposes-to-which-the-user-did-not-consent"><span class="secno">10.1.2.1.3</span> <span class="content">(<span>RP3</span>) Relying Party uses user information for purposes to which the user did not consent</span></a>
            <li><a href="#-rp4-relying-party-employs-client-state-based-tracking-to-identify-user"><span class="secno">10.1.2.1.4</span> <span class="content">(<span>RP4</span>) Relying Party employs client state-based tracking to identify user</span></a>
           </ol>
          <li>
           <a href="#identity-provider-collecting-information"><span class="secno">10.1.2.2</span> <span class="content">Identity Provider collecting information</span></a>
           <ol class="toc">
            <li><a href="#-idp1-identity-provider-tracking-user-sign-ins-to-relying-party-sites"><span class="secno">10.1.2.2.1</span> <span class="content">(<span>IDP1</span>) Identity Provider tracking user sign-ins to Relying Party sites</span></a>
            <li><a href="#-idp2-identity-provider-misusing-federated-sign-in-capabilities"><span class="secno">10.1.2.2.2</span> <span class="content">(<span>IDP2</span>) Identity Provider misusing federated sign-in capabilities</span></a>
           </ol>
          <li>
           <a href="#relying-party-and-identity-provider-colluding-to-collect-information"><span class="secno">10.1.2.3</span> <span class="content">Relying Party and Identity Provider colluding to collect information</span></a>
           <ol class="toc">
            <li><a href="#-col1-idp-exceeding-users-information-sharing-permission"><span class="secno">10.1.2.3.1</span> <span class="content">(<span>COL1</span>) IDP exceeding user’s information sharing permission</span></a>
            <li><a href="#-col2-rp-sharing-user-identifying-information-with-the-idp"><span class="secno">10.1.2.3.2</span> <span class="content">(<span>COL2</span>) RP sharing user-identifying information with the IDP</span></a>
           </ol>
         </ol>
        <li>
         <a href="#mitigation"><span class="secno">10.1.3</span> <span class="content">Mitigation</span></a>
         <ol class="toc">
          <li><a href="#directed-identifiers"><span class="secno">10.1.3.1</span> <span class="content">Directed identifiers</span></a>
          <li><a href="#browser-enforced-consent"><span class="secno">10.1.3.2</span> <span class="content">Browser-enforced consent</span></a>
          <li><a href="#identity-provider-policy"><span class="secno">10.1.3.3</span> <span class="content">Identity Provider policy</span></a>
          <li><a href="#denylists"><span class="secno">10.1.3.4</span> <span class="content">Denylists</span></a>
          <li><a href="#hiding-the-rp-from-the-idp"><span class="secno">10.1.3.5</span> <span class="content">Hiding the RP from the IDP</span></a>
          <li><a href="#identity-provider-has-a-relationship-with-the-rp"><span class="secno">10.1.3.6</span> <span class="content">Identity Provider has a relationship with the RP</span></a>
         </ol>
        <li><a href="#related-reading"><span class="secno">10.1.4</span> <span class="content">Related reading</span></a>
       </ol>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is non-normative.</em></p>
   <p>Over the last decade, identity federation has unquestionably played a central role in raising the bar for authentication on the web, in terms of ease-of-use (e.g. passwordless single sign-on), security (e.g. improved resistance to phishing and credential stuffing attacks) and trustworthiness compared to its preceding pattern: per-site usernames and passwords.</p>
   <p>The standards that define how identity federation works today on the Web were built independently of the Web Platform (namely, <a data-link-type="biblio" href="http://saml.xml.org/saml-specifications"><cite>SAML</cite></a>, <a data-link-type="biblio" href="https://openid.net/developers/specs/"><cite>OpenID</cite></a> and <a data-link-type="biblio" href="https://datatracker.ietf.org/doc/html/rfc6749"><cite>OAuth</cite></a>), and their designers had to (rightfully so) work around its limitations rather than extend them.</p>
   <p>Because of that, existing user authentication flows were designed on top of general-purpose web platform capabilities such as top-level navigations/redirects with parameters, window popups, iframes and cookies.</p>
   <p>However, because these general purpose primitives can be used for an open ended number of use cases (again, notably, by design), browsers have to apply policies that capture the lowest common denominator of abuse, at best applying cumbersome permissions (e.g. popup blockers) and at worst entirely blocking them (e.g. blocking third party cookies).</p>
   <p>Over the years, as these <a data-link-type="dfn" href="#low-level-api" id="ref-for-low-level-api">low-level API</a>s get abused, browsers intervene and federation adjusts itself. For example, popup blockers became common and federation had to adjust itself to work in a world where popups blockers were widely deployed.</p>
   <p>The challenge is that some of these low level primitives are getting increasingly abused to allow users on the web to be tracked. So, as a result, browsers are applying stricter and stricter policies around them.</p>
   <p>This specification defines a set of <a data-link-type="dfn" href="#high-level-api" id="ref-for-high-level-api①">high-level API</a>s that serve as a foundation where identity federation on Web can thrive without incurring into <a data-link-type="dfn">unsactioned tracking</a>.</p>
   <h2 class="heading settled" data-level="2" id="use-cases"><span class="secno">2. </span><span class="content">Use Cases</span><a class="self-link" href="#use-cases"></a></h2>
   <p>The below use case scenarios illustrate some basic supported flows. Additional scenarios, including sample code, are given later in the <a data-link-type="biblio" href="https://datatracker.ietf.org/doc/html/draft-bertocci-identity-in-browser-00"><cite>Identity Use Cases in Browser Catalog</cite></a>.</p>
   <h3 class="heading settled" data-level="2.1" id="use-cases-sign-up"><span class="secno">2.1. </span><span class="content">Sign-up</span><a class="self-link" href="#use-cases-sign-up"></a></h3>
   <p>A Sign-up occurs when the user is registering a new account at the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party①">Relying Party</a> using their <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider①">Identity Provider</a>.</p>
   <p>For example:</p>
   <ul>
    <li data-md>
     <p>A user navigates to a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party②">Relying Party</a> in a browser and decides to create an account.</p>
    <li data-md>
     <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party③">Relying Party</a> supports multiple <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider②">Identity Provider</a> as an authentication mechanism.</p>
    <li data-md>
     <p>A user selects their favorite <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider③">Identity Provider</a> to sign-up with.</p>
    <li data-md>
     <p>The <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider④">Identity Provider</a> prompts, "Do you want to create an account with the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party④">Relying Party</a>?"</p>
    <li data-md>
     <p>The user agrees.</p>
    <li data-md>
     <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party⑤">Relying Party</a> shows the message "Registration complete."</p>
    <li data-md>
     <p>An <a data-link-type="dfn" href="#account" id="ref-for-account">account</a> in created in the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party⑥">Relying Party</a> and a <a data-link-type="dfn" href="#session" id="ref-for-session">session</a> initialized.</p>
   </ul>
   <h3 class="heading settled" data-level="2.2" id="use-cases-sign-in"><span class="secno">2.2. </span><span class="content">Sign-in</span><a class="self-link" href="#use-cases-sign-in"></a></h3>
   <p>After a user navigates to a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party⑦">Relying Party</a> in a browser and decides to create an account by going through their <a href="#use-cases-sign-up">§ 2.1 Sign-up</a> flow, there are two ways a user logs into their <a data-link-type="dfn" href="#account" id="ref-for-account①">account</a> once their <a data-link-type="dfn" href="#session" id="ref-for-session①">session</a> expires:</p>
   <h4 class="heading settled" data-level="2.2.1" id="use-cases-auto-sign-in"><span class="secno">2.2.1. </span><span class="content">Auto Sign-in</span><a class="self-link" href="#use-cases-auto-sign-in"></a></h4>
   <p>Auto Sign-in occurs when the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider⑤">Identity Provider</a> has already gathered enough permission from the user to share their identity that it doesn’t block on gathering further permission and automatically signs the user in.</p>
   <p>For example:</p>
   <ul>
    <li data-md>
     <p>Using another device (e.g. their laptop):</p>
     <ul>
      <li data-md>
       <p>The user goes to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party⑧">Relying Party</a>.</p>
      <li data-md>
       <p>The user selects their favorite <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider⑥">Identity Provider</a> to sign-in.</p>
      <li data-md>
       <p>The <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider⑦">Identity Provider</a> remembers and proves that the user already has an <a data-link-type="dfn" href="#account" id="ref-for-account②">account</a> with the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party⑨">Relying Party</a>.</p>
      <li data-md>
       <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party①⓪">Relying Party</a> creates a new <a data-link-type="dfn" href="#session" id="ref-for-session②">session</a> for the user’s existing <a data-link-type="dfn" href="#account" id="ref-for-account③">account</a>.</p>
     </ul>
   </ul>
   <h4 class="heading settled" data-level="2.2.2" id="use-cases-explicit-sign-in"><span class="secno">2.2.2. </span><span class="content">Explicit Sign-in</span><a class="self-link" href="#use-cases-explicit-sign-in"></a></h4>
   <p>An explicit sign-in occurs when the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider⑧">Identity Provider</a> believes it is necessary to gather an explicit permission from the user to sign into a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party①①">Relying Party</a>, typically after the user goes through a <a href="#use-cases-sign-out">§ 2.3 Sign-out</a> flow.</p>
   <p>For example:</p>
   <ul>
    <li data-md>
     <p>The user decides to <a href="#use-cases-sign-out">§ 2.3 Sign-out</a> of the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party①②">Relying Party</a></p>
   </ul>
   <p>A few months later:</p>
   <ul>
    <li data-md>
     <p>The user navigates to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party①③">Relying Party</a></p>
    <li data-md>
     <p>The user selects their favorite <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider⑨">Identity Provider</a> to sign-in again.</p>
    <li data-md>
     <p>The <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider①⓪">Identity Provider</a> knows that:</p>
     <ul>
      <li data-md>
       <p>the user already has an account with the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party①④">Relying Party</a>.</p>
      <li data-md>
       <p>the user has logged out of the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party①⑤">Relying Party</a>.</p>
     </ul>
    <li data-md>
     <p>The <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider①①">Identity Provider</a> prompts, "Do you want to sign-in with the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party①⑥">Relying Party</a>?"</p>
    <li data-md>
     <p>The user agrees.</p>
    <li data-md>
     <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party①⑦">Relying Party</a> creates a new <a data-link-type="dfn" href="#session" id="ref-for-session③">session</a> for the user’s existing <a data-link-type="dfn" href="#account" id="ref-for-account④">account</a>.</p>
   </ul>
   <h3 class="heading settled" data-level="2.3" id="use-cases-sign-out"><span class="secno">2.3. </span><span class="content">Sign-out</span><a class="self-link" href="#use-cases-sign-out"></a></h3>
   <p>After a user navigates to a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party①⑧">Relying Party</a> in a browser and decides to create an <a data-link-type="dfn" href="#account" id="ref-for-account⑤">account</a> by going through their <a href="#use-cases-sign-up">§ 2.1 Sign-up</a> flow, there are two ways a user can clear their <a data-link-type="dfn" href="#session" id="ref-for-session④">session</a>s:</p>
   <h4 class="heading settled" data-level="2.3.1" id="use-cases-rp-sign-out"><span class="secno">2.3.1. </span><span class="content">RP Sign-out</span><a class="self-link" href="#use-cases-rp-sign-out"></a></h4>
   <ul>
    <li data-md>
     <p>On a shared computer:</p>
     <ul>
      <li data-md>
       <p>The user decides to close their session and logs out of the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party①⑨">Relying Party</a>.</p>
      <li data-md>
       <p>The user is now logged out of the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party②⓪">Relying Party</a>.</p>
      <li data-md>
       <p>Upon return to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party②①">Relying Party</a>, the user expects to go through an <a href="#use-cases-explicit-sign-in">§ 2.2.2 Explicit Sign-in</a>.</p>
     </ul>
   </ul>
   <h4 class="heading settled" data-level="2.3.2" id="use-cases-idp-sign-out"><span class="secno">2.3.2. </span><span class="content">IDP Sign-out</span><a class="self-link" href="#use-cases-idp-sign-out"></a></h4>
   <ul>
    <li data-md>
     <p>On a shared computer:</p>
     <ul>
      <li data-md>
       <p>The user decides to close their <a data-link-type="dfn" href="#session" id="ref-for-session⑤">session</a> and logs out of the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party②②">Relying Party</a>.</p>
      <li data-md>
       <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party②③">Relying Party</a> lets the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider①②">Identity Provider</a> know that the user wants to logout.</p>
      <li data-md>
       <p>The <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider①③">Identity Provider</a> logs the user out of all of the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party②④">Relying Party</a>s and itself.</p>
      <li data-md>
       <p>Upon return to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party②⑤">Relying Party</a>, the goes through an <a href="#use-cases-explicit-sign-in">§ 2.2.2 Explicit Sign-in</a>.</p>
     </ul>
   </ul>
   <h3 class="heading settled" data-level="2.4" id="use-cases-revocation"><span class="secno">2.4. </span><span class="content">Revocation</span><a class="self-link" href="#use-cases-revocation"></a></h3>
   <p>After a user navigates to a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party②⑥">Relying Party</a> in a browser and decides to create an account by going through their <a href="#use-cases-sign-up">§ 2.1 Sign-up</a> flow, there are two ways a user can cancel their account:</p>
   <h4 class="heading settled" data-level="2.4.1" id="use-cases-idp-revocation"><span class="secno">2.4.1. </span><span class="content">IDP Revocation</span><a class="self-link" href="#use-cases-idp-revocation"></a></h4>
   <ul>
    <li data-md>
     <p>On the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider①④">Identity Provider</a>:</p>
     <ul>
      <li data-md>
       <p>The user decides to cancel their account.</p>
      <li data-md>
       <p>The user goes to their <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider①⑤">Identity Provider</a> and revokes access to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party②⑦">Relying Party</a>.</p>
      <li data-md>
       <p>Upon return to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party②⑧">Relying Party</a>, the user expects to go through a <a href="#use-cases-sign-up">§ 2.1 Sign-up</a>.</p>
     </ul>
   </ul>
   <h4 class="heading settled" data-level="2.4.2" id="use-cases-rp-revocation"><span class="secno">2.4.2. </span><span class="content">RP Revocation</span><a class="self-link" href="#use-cases-rp-revocation"></a></h4>
   <ul>
    <li data-md>
     <p>On the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party②⑨">Relying Party</a>:</p>
     <ul>
      <li data-md>
       <p>The user decides to cancel their account.</p>
      <li data-md>
       <p>The user navigates to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party③⓪">Relying Party</a> and cancels their account, also letting the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider①⑥">Identity Provider</a> know.</p>
      <li data-md>
       <p>Upon return to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party③①">Relying Party</a>, the user expects to go through a <a href="#sign-up" id="ref-for-sign-up"></a>.</p>
     </ul>
   </ul>
   <h3 class="heading settled" data-level="2.5" id="Access"><span class="secno">2.5. </span><span class="content">Access</span><a class="self-link" href="#Access"></a></h3>
   <ul>
    <li data-md>
     <p>A user navigates to a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party③②">Relying Party</a> in a browser and decides to create an <a data-link-type="dfn" href="#account" id="ref-for-account⑥">account</a>.</p>
    <li data-md>
     <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party③③">Relying Party</a> supports multiple <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider①⑦">Identity Provider</a> which provide access to the user’s Calendar.</p>
    <li data-md>
     <p>A user selects their favorite <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider①⑧">Identity Provider</a> to sign-up with.</p>
    <li data-md>
     <p>The <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider①⑨">Identity Provider</a> prompts, "Do you want to give access to your Calendar to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party③④">Relying Party</a>?"</p>
    <li data-md>
     <p>The user agrees.</p>
    <li data-md>
     <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party③⑤">Relying Party</a> shows message, "Registration complete.", creates a <a data-link-type="dfn" href="#session" id="ref-for-session⑥">session</a> for the user and</p>
    <li data-md>
     <p>Shows the user their calendar entries provided by the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider②⓪">Identity Provider</a>.</p>
   </ul>
   <h2 class="heading settled" data-level="3" id="examples"><span class="secno">3. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h2>
   <p>This specification extends the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential">FederatedCredential</a></code> type and internal algorithms to allow the exchange
of identity between <a data-link-type="dfn" href="#idp" id="ref-for-idp">IDP</a>s and <a data-link-type="dfn" href="#rp" id="ref-for-rp">RP</a>s. When it succeeds, it returns to the <a data-link-type="dfn" href="#rp" id="ref-for-rp①">RP</a> a signed <a data-link-type="dfn" href="#id-token" id="ref-for-id-token">id token</a> which the <a data-link-type="dfn" href="#rp" id="ref-for-rp②">RP</a> can use to authenticate the user.</p>
   <div class="example" id="example-4b8efa39">
    <a class="self-link" href="#example-4b8efa39"></a> 
<pre class="language-js highlight"><c- k>async</c-> <c- a>function</c-> login<c- p>(</c->signal<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> <c- p>{</c->idToken<c- p>}</c-> <c- o>=</c-> <c- k>await</c-> navigator<c- p>.</c->credentials<c- p>.</c->get<c- p>({</c->
    <c- c1>// controls whether auto sign-in is enabled or not</c->
    mediation<c- o>:</c-> <c- u>"optional"</c-><c- p>,</c->
    <c- c1>// controls abortions of the account chooser</c->
    signal<c- o>:</c-> signal

    <c- c1>// controls which identity providers to use</c->
    federated<c- o>:</c-> <c- p>{</c->
      <c- c1>// controls whether the account chooser is modal or not</c->
      providers<c- o>:</c-> <c- p>[{</c->
        url<c- o>:</c-> <c- u>"https://idp.example"</c-><c- p>,</c->
        <c- c1>// the pre-registered client id  </c->
        clientId<c- o>:</c-> <c- u>"123"</c-><c- p>,</c->
        nonce<c- o>:</c-> <c- u>"456"</c->
      <c- p>}],</c->
    <c- p>}</c->
  <c- p>});</c->

  <c- k>return</c-> idToken<c- p>;</c->
<c- p>}</c->
</pre>
   </div>
   <h2 class="heading settled" data-level="4" id="terminology"><span class="secno">4. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h2>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="relying-party">Relying Party</dfn>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="rp">RP</dfn>
    <dt data-md><dfn data-dfn-type="dfn" data-noexport id="website">Website<a class="self-link" href="#website"></a></dfn>
    <dd data-md>
     <p>TODO(goto): find existing definitions.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="identity-provider">Identity Provider</dfn>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="idp">IDP</dfn>
    <dd data-md>
     <p>TODO(goto): find existing definition.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="session">session</dfn>
    <dd data-md>
     <p>TODO(goto): find existing definition.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="account">account</dfn>
    <dd data-md>
     <p>TODO(goto): find existing definition.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="id-token">id token</dfn>
    <dd data-md>
     <p>TODO(goto): find existing definition.</p>
    <dt data-md>
     <df>unsactioned tracking </df>
    <dd data-md>
     <p>The type of tracking on the web described in <a data-link-type="biblio" href="https://www.w3.org/2001/tag/doc/unsanctioned-tracking/"><cite>Unsactioned Web Tracking</cite></a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="high-level-api">high-level API</dfn>
    <dd data-md>
     <p>A use case specific API, as opposed to a <a data-link-type="dfn" href="#low-level-api" id="ref-for-low-level-api①">low-level API</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="low-level-api">low-level API</dfn>
    <dd data-md>
     <p>A general purpose API, as opposed to a <a data-link-type="dfn" href="#high-level-api" id="ref-for-high-level-api②">high-level API</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="registered">registered</dfn>
    <dd data-md>
     <p>TODO(goto): find existing definition.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="unregistered">unregistered</dfn>
    <dd data-md>
     <p>TODO(goto): find existing definition.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="logged-in">logged in</dfn>
    <dd data-md>
     <p>TODO(goto): find existing definition.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="logged-out">logged out</dfn>
    <dd data-md>
     <p>TODO(goto): find existing definition.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="out-of-band">out-of-band</dfn>
    <dd data-md>
     <p>Outside of the user agent’s context.</p>
   </dl>
   <h2 class="heading settled" data-level="5" id="lifecycle"><span class="secno">5. </span><span class="content">High Level Design</span><a class="self-link" href="#lifecycle"></a></h2>
   <p>At a high level, the Identity Federation Management API works by the intermediation of cooperating <a data-link-type="dfn" href="#idp" id="ref-for-idp①">IDP</a>s and <a data-link-type="dfn" href="#rp" id="ref-for-rp③">RP</a>s.</p>
   <p>The <a href="#idp-api">§ 6 The Identity Provider API</a> and the <a href="#rp-api">§ 7 The Relying Party API</a> defines a set of HTTP APIs that cooperating <a data-link-type="dfn" href="#idp" id="ref-for-idp②">IDP</a>s and <a data-link-type="dfn" href="#idp" id="ref-for-idp③">IDP</a>s exposes as well as the entry points in the <a href="#API">§ 8 The Browser API</a> that they can use.</p>
   <p><img src="static/mock43.svg"></p>
   <p>The user agent intermediates in such a matter that makes it impractical for the API to be used for tracking purposes, while preserving the functionality of identity federation.</p>
   <p>This document defines the APIs in the following order:</p>
   <ol>
    <li data-md>
     <p>The <a href="#idp-api">§ 6 The Identity Provider API</a></p>
    <li data-md>
     <p>The <a href="#rp-api">§ 7 The Relying Party API</a></p>
    <li data-md>
     <p>The <a href="#API">§ 8 The Browser API</a></p>
   </ol>
   <h2 class="heading settled" data-level="6" id="idp-api"><span class="secno">6. </span><span class="content">The Identity Provider API</span><a class="self-link" href="#idp-api"></a></h2>
   <p>The <a data-link-type="dfn" href="#idp" id="ref-for-idp④">IDP</a> proactively and cooperatively exposes itself as a comformant agent by exposing a series of HTTP endpoints:</p>
   <ol>
    <li data-md>
     <p>A <a href="#well-known">§ 6.1 Discovery</a> endpoint in a well-known location that points to</p>
    <li data-md>
     <p>An <a href="#accounts_endpoint">§ 6.2 Accounts List</a> endpoint</p>
    <li data-md>
     <p>A <a href="#client_id_metadata_endpoint">§ 6.3 Client Metadata</a> endpoint</p>
    <li data-md>
     <p>An <a href="#idtoken_endpoint">§ 6.4 ID Token</a> endpoint</p>
   </ol>
   <h3 class="heading settled" data-level="6.1" id="well-known"><span class="secno">6.1. </span><span class="content">Discovery</span><a class="self-link" href="#well-known"></a></h3>
   <p>The well-known discovery endpoint is an endpoint located at the <a data-link-type="dfn" href="#idp" id="ref-for-idp⑤">IDP</a>'s <code>.well-known/webid</code> and serves as a discovery device to other endpoints provided by the <a data-link-type="dfn" href="#idp" id="ref-for-idp⑥">IDP</a>.</p>
   <p>The well-known discovery endpoint is fetched (a) <strong>without</strong> cookies and (b) <strong>with</strong> a special <a href="#Sec-WebID-CSR">§ 6.6 Sec-WebID-CSR</a> header.</p>
   <p>For example:</p>
   <div class="example" id="example-d6b169db">
    <a class="self-link" href="#example-d6b169db"></a> 
<pre class="language-http highlight">GET /.well-known/webid HTTPS/1.1
Host: idp.example
Content-Type: application/json
Sec-WebID-CSRF: random_value
</pre>
   </div>
   <p>The file is parsed expecting the following properties:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="WellKnown" data-dfn-type="argument" data-export id="dom-wellknown-accounts_endpoint"><code>accounts_endpoint</code></dfn>
    <dd data-md>
     <p>A URL that points to an HTTP API that complies with the <a href="#accounts_endpoint">§ 6.2 Accounts List</a> API.</p>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="WellKnown" data-dfn-type="argument" data-export id="dom-wellknown-client_id_metadata_endpoint"><code>client_id_metadata_endpoint</code></dfn>
    <dd data-md>
     <p>A URL that points to an HTTP API that complies with the <a href="#client_id_metadata_endpoint">§ 6.3 Client Metadata</a> API.</p>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="WellKnown" data-dfn-type="argument" data-export id="dom-wellknown-idtoken_endpoint"><code>idtoken_endpoint</code></dfn>
    <dd data-md>
     <p>A URL that points to an HTTP API that complies with the <a href="#idtoken_endpoint">§ 6.4 ID Token</a> API.</p>
   </dl>
   <p>For example:</p>
   <div class="example" id="example-8076d186">
    <a class="self-link" href="#example-8076d186"></a> 
<pre class="language-json highlight"><c- p>{</c->
  <c- f>"accounts_endpoint"</c-><c- p>:</c-> <c- u>"/accounts.php"</c-><c- p>,</c->
  <c- f>"client_id_metadata_endpoint"</c-><c- p>:</c-> <c- u>"/metadata.php"</c-><c- p>,</c->
  <c- f>"idtoken_endpoint"</c-><c- p>:</c-> <c- u>"/idtokens.php"</c-><c- p>,</c->
<c- p>}</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="6.2" id="accounts_endpoint"><span class="secno">6.2. </span><span class="content">Accounts List</span><a class="self-link" href="#accounts_endpoint"></a></h3>
   <p>The accounts list endpoint provides the list of accounts the user has at the <a data-link-type="dfn" href="#idp" id="ref-for-idp⑦">IDP</a>.</p>
   <p>The accounts list endpoint is fetched (a) <strong>with</strong> any cookies and (b) <strong>with</strong> a special <a href="#Sec-WebID-CSR">§ 6.6 Sec-WebID-CSR</a> header.</p>
   <p>For example:</p>
   <div class="example" id="example-026e262e">
    <a class="self-link" href="#example-026e262e"></a> 
<pre class="language-http highlight">GET /accounts_list.php HTTPS/1.1
Host: idp.example
Content-Type: application/json
Cookie: 0x23223
Sec-WebID-CSRF: random_value
</pre>
   </div>
   <p>The response is expected to have the following properties:</p>
   <dl>
    <dt data-md><dfn class="idl-code" data-dfn-for="accounts_endpoint_response" data-dfn-type="argument" data-export id="dom-accounts_endpoint_response-accounts"><code>accounts</code><a class="self-link" href="#dom-accounts_endpoint_response-accounts"></a></dfn>
    <dd data-md>
     <p>A list of <a data-link-type="dfn" href="#account-json" id="ref-for-account-json">Account JSON</a>.</p>
   </dl>
   <p>Every <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="account-json">Account JSON</dfn> is expected to have the following properties:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="accounts_endpoint_response_accounts" data-dfn-type="argument" data-export id="dom-accounts_endpoint_response_accounts-account_id"><code>account_id</code></dfn>
    <dd data-md>
     <p>An account identifier.</p>
    <dt data-md><dfn class="idl-code" data-dfn-for="accounts_endpoint_response_accounts" data-dfn-type="argument" data-export id="dom-accounts_endpoint_response_accounts-name"><code>name</code><a class="self-link" href="#dom-accounts_endpoint_response_accounts-name"></a></dfn>
    <dd data-md>
     <p>The user’s full name.</p>
    <dt data-md><dfn class="idl-code" data-dfn-for="accounts_endpoint_response_accounts" data-dfn-type="argument" data-export id="dom-accounts_endpoint_response_accounts-given_name"><code>given_name</code><a class="self-link" href="#dom-accounts_endpoint_response_accounts-given_name"></a></dfn>
    <dd data-md>
     <p>The user’s given name.</p>
    <dt data-md><dfn class="idl-code" data-dfn-for="accounts_endpoint_response_accounts" data-dfn-type="argument" data-export id="dom-accounts_endpoint_response_accounts-email"><code>email</code><a class="self-link" href="#dom-accounts_endpoint_response_accounts-email"></a></dfn>
    <dd data-md>
     <p>The user’s email address.</p>
    <dt data-md><dfn class="idl-code" data-dfn-for="accounts_endpoint_response_accounts" data-dfn-type="argument" data-export id="dom-accounts_endpoint_response_accounts-picture"><code>picture</code><a class="self-link" href="#dom-accounts_endpoint_response_accounts-picture"></a></dfn>
    <dd data-md>
     <p>The user’s profile picture.</p>
   </dl>
   <p>For example:</p>
   <div class="example" id="example-034c7a99">
    <a class="self-link" href="#example-034c7a99"></a> 
<pre class="language-json highlight"><c- p>{</c->
 <c- f>"accounts"</c-><c- p>:</c-> <c- p>[{</c-> 
   <c- f>"account_id"</c-><c- p>:</c-> <c- u>"1234"</c-><c- p>,</c-> 
   <c- f>"given_name"</c-><c- p>:</c-> <c- u>"John"</c-><c- p>,</c->  
   <c- f>"name"</c-><c- p>:</c-> <c- u>"John Doe"</c-><c- p>,</c->
   <c- f>"email"</c-><c- p>:</c-> <c- u>"john_doe@idp.example"</c-><c- p>,</c-> 
   <c- f>"picture"</c-><c- p>:</c-> <c- u>"https://idp.example/profile/123"</c-><c- p>,</c->
  <c- p>},</c-> <c- p>{</c->
   <c- f>"account_id"</c-><c- p>:</c-> <c- u>"5678"</c-><c- p>,</c-> 
   <c- f>"given_name"</c-><c- p>:</c-> <c- u>"Johnny"</c-><c- p>,</c-> 
   <c- f>"name"</c-><c- p>:</c-> <c- u>"Johnny"</c-><c- p>,</c->
   <c- f>"email"</c-><c- p>:</c-> <c- u>"johnny@idp.example"</c-><c- p>,</c->
   <c- f>"picture"</c-><c- p>:</c-> <c- u>"https://idp.example/profile/456"</c->
  <c- p>}]</c->
<c- p>}</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="6.3" id="client_id_metadata_endpoint"><span class="secno">6.3. </span><span class="content">Client Metadata</span><a class="self-link" href="#client_id_metadata_endpoint"></a></h3>
   <p>The client metadata endpoint provides metadata about <a data-link-type="dfn" href="#rp" id="ref-for-rp④">RP</a>s.</p>
   <p>The client medata endpoint is fetched (a) <strong>without</strong> cookies and (b) <strong>with</strong> a special <a href="#Sec-WebID-CSR">§ 6.6 Sec-WebID-CSR</a> header.</p>
   <p>For example:</p>
   <div class="example" id="example-21872a8c">
    <a class="self-link" href="#example-21872a8c"></a> 
<pre class="language-http highlight">GET /client_medata.php HTTPS/1.1
Host: idp.example
Content-Type: application/json
Sec-WebID-CSRF: random_value
</pre>
   </div>
   <p>The file is parsed expecting the following properties:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="client_id_metadata_endpont_response" data-dfn-type="argument" data-export id="dom-client_id_metadata_endpont_response-privacy_policy_url"><code>privacy_policy_url</code></dfn>
    <dd data-md>
     <p>A link to the <a data-link-type="dfn" href="#rp" id="ref-for-rp⑤">RP</a>'s privacy policy.</p>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="client_id_metadata_endpont_response" data-dfn-type="argument" data-export id="dom-client_id_metadata_endpont_response-terms_of_service_url"><code>terms_of_service_url</code></dfn>
    <dd data-md>
     <p>A link to the <a data-link-type="dfn" href="#rp" id="ref-for-rp⑥">RP</a>'s terms of service.</p>
   </dl>
   <p>For example:</p>
   <div class="example" id="example-56e40745">
    <a class="self-link" href="#example-56e40745"></a> 
<pre class="language-json highlight"><c- p>{</c->
  <c- f>"privacy_policy_url"</c-><c- p>:</c-> <c- u>"/privacy.html"</c-><c- p>,</c->
  <c- f>"terms_of_service_url"</c-><c- p>:</c-> <c- u>"/terms.html"</c-><c- p>,</c->
<c- p>}</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="6.4" id="idtoken_endpoint"><span class="secno">6.4. </span><span class="content">ID Token</span><a class="self-link" href="#idtoken_endpoint"></a></h3>
   <p>The ID Token endpoint is responsible for minting a new idtoken for the user.</p>
   <p>The ID Token endpoint is fetched (a) as a <strong>POST</strong> request, (b) <strong>with</strong> cookies and (c) <strong>with</strong> a special <a href="#Sec-WebID-CSR">§ 6.6 Sec-WebID-CSR</a> header.</p>
   <p>It will also contain the following parameters passed as a JSON object:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="idtoken_endpoint_request" data-dfn-type="argument" data-export id="dom-idtoken_endpoint_request-account_id"><code>account_id</code></dfn>
    <dd data-md>
     <p>The account identifier that was selected.</p>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="idtoken_endpoint_request" data-dfn-type="argument" data-export id="dom-idtoken_endpoint_request-request"><code>request</code></dfn>
    <dd data-md>
     <p>The <a data-link-type="dfn" href="#rp-request" id="ref-for-rp-request">RP request</a></p>
   </dl>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="rp-request">RP request</dfn> has the following properties:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="idtoken_endpoint_request_request" data-dfn-type="argument" data-export id="dom-idtoken_endpoint_request_request-client_id"><code>client_id</code></dfn>
    <dd data-md>
     <p>The <a data-link-type="dfn" href="#rp" id="ref-for-rp⑦">RP</a>'s client it</p>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="idtoken_endpoint_request_request" data-dfn-type="argument" data-export id="dom-idtoken_endpoint_request_request-nonce"><code>nonce</code></dfn>
    <dd data-md>
     <p>A random number of the choice of the <a data-link-type="dfn" href="#rp" id="ref-for-rp⑧">RP</a></p>
   </dl>
   <p>For example:</p>
   <div class="example" id="example-afad4478">
    <a class="self-link" href="#example-afad4478"></a> 
<pre class="language-http highlight">POST /webid_token_endpoint HTTPS/1.1
Host: idp.example
Referrer: rp.example
Content-Type: application/json
Cookie: 0x23223
Sec-WebID-CSRF: random_value
{
  "account_id": "123",
  "request": {
    "client_id": "client1234",
    "nonce": "Ct60bD" 
  }
}
</pre>
   </div>
   <p>The response is parsed as a JSON file expecting the following properties:</p>
   <dl>
    <dt data-md><dfn class="idl-code" data-dfn-for="idtoken_endpoint_response" data-dfn-type="argument" data-export id="dom-idtoken_endpoint_response-id_token"><code>id_token</code><a class="self-link" href="#dom-idtoken_endpoint_response-id_token"></a></dfn>
    <dd data-md>
     <p>The resulting <a data-link-type="dfn" href="#id-token" id="ref-for-id-token①">id token</a>.</p>
   </dl>
   <p>For example:</p>
   <div class="example" id="example-e01ff354">
    <a class="self-link" href="#example-e01ff354"></a> 
<pre class="language-json highlight"><c- p>{</c->
  <c- f>"id_token"</c-> <c- p>:</c-> <c- u>"eyJC...J9.eyJzdWTE2...MjM5MDIyfQ.SflV_adQssw....5c"</c->
<c- p>}</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="6.5" id="revocation_endpoint"><span class="secno">6.5. </span><span class="content">Revocation</span><a class="self-link" href="#revocation_endpoint"></a></h3>
   <p class="note" role="note"><span>Note:</span> support revocation.</p>
   <h3 class="heading settled" data-level="6.6" id="Sec-WebID-CSR"><span class="secno">6.6. </span><span class="content"><code><dfn data-dfn-type="dfn" data-export id="sec-webid-csr"><code>Sec-WebID-CSR</code><a class="self-link" href="#sec-webid-csr"></a></dfn></code></span><a class="self-link" href="#Sec-WebID-CSR"></a></h3>
   <h2 class="heading settled" data-level="7" id="rp-api"><span class="secno">7. </span><span class="content">The Relying Party API</span><a class="self-link" href="#rp-api"></a></h2>
   <p><a data-link-type="dfn" href="#rp" id="ref-for-rp⑨">RP</a>'s expose a <a href="#logout_endpoint">§ 7.1 Logout</a> to facilitate with <a href="#use-cases-idp-sign-out">§ 2.3.2 IDP Sign-out</a>.</p>
   <h3 class="heading settled" data-level="7.1" id="logout_endpoint"><span class="secno">7.1. </span><span class="content">Logout</span><a class="self-link" href="#logout_endpoint"></a></h3>
   <p>When <a data-link-type="dfn" href="#idp" id="ref-for-idp⑧">IDP</a>s call the <a href="#idp-sign-out">§ 8.4.2 IDP Sign-out</a> API, every <a data-link-type="dfn" href="#rp" id="ref-for-rp①⓪">RP</a> gets a
chance to log the user out (e.g. clear cookies, clear local storage)
via the logout endpoint.</p>
   <p>The logout endpoint is an endpoint that is registered with the <a data-link-type="dfn" href="#idp" id="ref-for-idp⑨">IDP</a> <a data-link-type="dfn" href="#out-of-band" id="ref-for-out-of-band">out-of-band</a>.</p>
   <p>The logout endpoint is called (a) with a <strong>GET</strong> and (b) with the <a data-link-type="dfn" href="#rp" id="ref-for-rp①①">RP</a>'s cookies.</p>
   <h2 class="heading settled" data-level="8" id="API"><span class="secno">8. </span><span class="content">The Browser API</span><a class="self-link" href="#API"></a></h2>
   <p>The Browser API exposes APIs to <a data-link-type="dfn" href="#rp" id="ref-for-rp①②">RP</a>s and <a data-link-type="dfn" href="#idp" id="ref-for-idp①⓪">IDP</a>s to call and intermediates the exchange of the user’s identity.</p>
   <p>For <a data-link-type="dfn" href="#rp" id="ref-for-rp①③">RP</a>s, it allows them to:</p>
   <ol>
    <li data-md>
     <p>The <a href="#sign-in">§ 8.2 The Sign-in API</a> allows <a data-link-type="dfn" href="#rp" id="ref-for-rp①④">RP</a>'s users to <a href="#use-cases-sign-up">§ 2.1 Sign-up</a> and <a href="#use-cases-sign-up">§ 2.1 Sign-up</a></p>
    <li data-md>
     <p>The <a href="#revocation">§ 8.3 The Revocation API</a> allows <a data-link-type="dfn" href="#rp" id="ref-for-rp①⑤">RP</a>'s users to go through <a href="#use-cases-rp-revocation">§ 2.4.2 RP Revocation</a> of their accounts</p>
    <li data-md>
     <p>The <a href="#rp-sign-out">§ 8.4.1 RP Sign-out</a> API allows <a data-link-type="dfn" href="#rp" id="ref-for-rp①⑥">RP</a>s to <a href="#use-cases-rp-sign-out">§ 2.3.1 RP Sign-out</a> of their accounts.</p>
   </ol>
   <p>For <a data-link-type="dfn" href="#idp" id="ref-for-idp①①">IDP</a>s, it allows them to:</p>
   <ol>
    <li data-md>
     <p>The <a href="#idp-sign-out">§ 8.4.2 IDP Sign-out</a> API allows <a data-link-type="dfn" href="#idp" id="ref-for-idp①②">IDP</a>s to <a href="#use-cases-idp-sign-out">§ 2.3.2 IDP Sign-out</a> of their accounts.</p>
   </ol>
   <p>The Browser API manages the lifecycle of the user’s accounts and sessions with an internal <a href="#state-machine">§ 8.1 The State Machine</a>.</p>
   <h3 class="heading settled" data-level="8.1" id="state-machine"><span class="secno">8.1. </span><span class="content">The State Machine</span><a class="self-link" href="#state-machine"></a></h3>
   <p>Internally, the account management and session management APIs allows the user to explicitly move through the different stages of their accounts. At each stage, the state machine manages the <a data-link-type="dfn" href="#rp" id="ref-for-rp①⑦">RP</a>'s and the <a data-link-type="dfn" href="#idp" id="ref-for-idp①③">IDP</a>'s access to the appropriate browser capabilities.</p>
   <p><img src="static/mock42.svg"></p>
   <dl>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="StateMachine" data-dfn-type="argument" data-export id="dom-statemachine-account-state"><code>Account State</code></dfn>
    <dd data-md>
     <p>Keeps track of whether the user has an account or not. Can be <a data-link-type="dfn" href="#registered" id="ref-for-registered">registered</a> or (by default) <a data-link-type="dfn" href="#unregistered" id="ref-for-unregistered">unregistered</a>.</p>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="StateMachine" data-dfn-type="argument" data-export id="dom-statemachine-session-state"><code>Session State</code></dfn>
    <dd data-md>
     <p>Keeps track of whether the user has an open or closed session. Can be <a data-link-type="dfn" href="#logged-in" id="ref-for-logged-in">logged in</a> or (by default) <a data-link-type="dfn" href="#logged-out" id="ref-for-logged-out">logged out</a>.</p>
   </dl>
   <h3 class="heading settled" data-level="8.2" id="sign-in"><span class="secno">8.2. </span><span class="content">The Sign-in API</span><a class="self-link" href="#sign-in"></a></h3>
   <p>The Sign-up and Sign-in APIs are APIs used by the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party③⑥">Relying Party</a>s to ask the browser to intermediate the relationship with the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider②①">Identity Provider</a> and the provisioning of an <a data-link-type="dfn" href="#id-token" id="ref-for-id-token②">id token</a>.</p>
   <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party③⑦">Relying Party</a> makes no delineation between Sign-up and Sign-in, but rather call the same API indistinguishably. The most important parameter to the API call is the set of <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider②②">Identity Provider</a>s that the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party③⑧">Relying Party</a> supports and has pre-registered with (i.e. it has a <code>clientId</code>).</p>
   <p>Additionally, the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party③⑨">Relying Party</a> can control a variety of UX knobs. For example, whether to allow an <a href="#use-cases-auto-sign-in">§ 2.2.1 Auto Sign-in</a> flow and an AbortSignal in case it needs to abort the flow.</p>
   <p>If all goes well, the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party④⓪">Relying Party</a> receives back an <a data-link-type="dfn" href="#id-token" id="ref-for-id-token③">id token</a> in the form of a signed <a data-link-type="biblio" href="https://datatracker.ietf.org/doc/html/rfc7519"><cite>JWT</cite></a> which it can use to authenticate the user.</p>
   <div class="example" id="example-4b8efa39①">
    <a class="self-link" href="#example-4b8efa39①"></a> 
<pre class="language-js highlight"><c- k>async</c-> <c- a>function</c-> login<c- p>(</c->signal<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> <c- p>{</c->idToken<c- p>}</c-> <c- o>=</c-> <c- k>await</c-> navigator<c- p>.</c->credentials<c- p>.</c->get<c- p>({</c->
    <c- c1>// controls whether auto sign-in is enabled or not</c->
    mediation<c- o>:</c-> <c- u>"optional"</c-><c- p>,</c->
    <c- c1>// controls abortions of the account chooser</c->
    signal<c- o>:</c-> signal

    <c- c1>// controls which identity providers to use</c->
    federated<c- o>:</c-> <c- p>{</c->
      <c- c1>// controls whether the account chooser is modal or not</c->
      providers<c- o>:</c-> <c- p>[{</c->
        url<c- o>:</c-> <c- u>"https://idp.example"</c-><c- p>,</c->
        <c- c1>// the pre-registered client id  </c->
        clientId<c- o>:</c-> <c- u>"123"</c-><c- p>,</c->
        nonce<c- o>:</c-> <c- u>"456"</c->
      <c- p>}],</c->
    <c- p>}</c->
  <c- p>});</c->

  <c- k>return</c-> idToken<c- p>;</c->
<c- p>}</c->
</pre>
   </div>
   <p>To accomplish that, this specification does three things:</p>
   <ol>
    <li data-md>
     <p>It extends <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential①">FederatedCredential</a></code> with more fields.</p>
    <li data-md>
     <p>It redefines <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential②">FederatedCredential</a></code>'s <code><dfn class="idl-code" data-dfn-for="FederatedCredential" data-dfn-type="method" data-export id="dom-federatedcredential-discoverfromexternalsource-slot"><code>[[DiscoverFromExternalSource]]()</code><a class="self-link" href="#dom-federatedcredential-discoverfromexternalsource-slot"></a></dfn></code>.</p>
    <li data-md>
     <p>It extends <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#dictdef-federatedcredentialrequestoptions" id="ref-for-dictdef-federatedcredentialrequestoptions">FederatedCredentialRequestOptions</a></code> with more options.</p>
   </ol>
   <p>First, this specification extends the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential③">FederatedCredential</a></code> type adding two more fields:</p>
<pre class="idl highlight def"><c- b>enum</c-> <dfn class="idl-code" data-dfn-type="enum" data-export id="enumdef-federatedcredentialapprovedby"><code><c- g>FederatedCredentialApprovedBy</c-></code><a class="self-link" href="#enumdef-federatedcredentialapprovedby"></a></dfn> {
  <dfn class="idl-code" data-dfn-for="FederatedCredentialApprovedBy" data-dfn-type="enum-value" data-export id="dom-federatedcredentialapprovedby-auto"><code><c- s>"auto"</c-></code><a class="self-link" href="#dom-federatedcredentialapprovedby-auto"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="FederatedCredentialApprovedBy" data-dfn-type="enum-value" data-export id="dom-federatedcredentialapprovedby-user"><code><c- s>"user"</c-></code><a class="self-link" href="#dom-federatedcredentialapprovedby-user"></a></dfn>
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential④"><c- g>FederatedCredential</c-></a> : <a data-link-type="idl-name" href="https://w3c.github.io/webappsec-credential-management/#credential" id="ref-for-credential"><c- n>Credential</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="FederatedCredential" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-federatedcredential-idtoken"><code><c- g>idToken</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name"><c- n>FederatedCredentialApprover</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="FederatedCredential" data-dfn-type="attribute" data-export data-readonly data-type="FederatedCredentialApprover" id="dom-federatedcredential-approvedby"><code><c- g>approvedBy</c-></code></dfn>;
};
</pre>
   <dl>
    <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-federatedcredential-idtoken" id="ref-for-dom-federatedcredential-idtoken">idToken</a></code>
    <dd data-md>
     <p>The <a data-link-type="dfn" href="#id-token" id="ref-for-id-token④">id token</a>.</p>
    <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-federatedcredential-approvedby" id="ref-for-dom-federatedcredential-approvedby">approvedBy</a></code>
    <dd data-md>
     <p>When used in conjunction with <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#dom-credentialrequestoptions-mediation" id="ref-for-dom-credentialrequestoptions-mediation">mediation</a></code>, it indicates whether the credential was provided via a <a href="#use-cases-auto-sign-in">§ 2.2.1 Auto Sign-in</a> or an <a href="#use-cases-explicit-sign-in">§ 2.2.2 Explicit Sign-in</a>.</p>
   </dl>
   <p>Second, it extends the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#dictdef-federatedcredentialrequestoptions" id="ref-for-dictdef-federatedcredentialrequestoptions①">FederatedCredentialRequestOptions</a></code> by adding a list of <code class="idl"><a data-link-type="idl" href="#dictdef-federatedidentityprovider" id="ref-for-dictdef-federatedidentityprovider">FederatedIdentityProvider</a></code>s:</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>dictionary</c-> <a class="idl-code" data-link-type="dictionary" href="https://w3c.github.io/webappsec-credential-management/#dictdef-federatedcredentialrequestoptions" id="ref-for-dictdef-federatedcredentialrequestoptions②"><c- g>FederatedCredentialRequestOptions</c-></a> {
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence" id="ref-for-idl-sequence"><c- b>sequence</c-></a>&lt;(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#dictdef-federatedidentityprovider" id="ref-for-dictdef-federatedidentityprovider①"><c- n>FederatedIdentityProvider</c-></a>)> <dfn class="dfn-paneled idl-code" data-dfn-for="FederatedCredentialRequestOptions" data-dfn-type="dict-member" data-export data-type="sequence<(DOMString or FederatedIdentityProvider)> " id="dom-federatedcredentialrequestoptions-providers"><code><c- g>providers</c-></code></dfn>;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-federatedidentityprovider"><code><c- g>FederatedIdentityProvider</c-></code></dfn> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="FederatedIdentityProvider" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-federatedidentityprovider-url"><code><c- g>url</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString②"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="FederatedIdentityProvider" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-federatedidentityprovider-clientid"><code><c- g>clientId</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString③"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="FederatedIdentityProvider" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-federatedidentityprovider-nonce"><code><c- g>nonce</c-></code></dfn>;
};
</pre>
   <p>And finally, this specification overrides the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential⑤">FederatedCredential</a></code>'s <code><dfn class="idl-code" data-dfn-for="FederatedCredential" data-dfn-type="method" data-export id="dom-federatedcredential-discoverfromexternalsource-origin-options-sameoriginwithancestors-slot"><code>[[DiscoverFromExternalSource]](origin, options, sameOriginWithAncestors)</code><a class="self-link" href="#dom-federatedcredential-discoverfromexternalsource-origin-options-sameoriginwithancestors-slot"></a></dfn></code> Method.</p>
   <p>This algorithm runs in parallel inside the <a href="https://w3c.github.io/webappsec-credential-management/#algorithm-request">Credential Management § algorithm-request</a> to request credentials and returns a set of <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential⑥">FederatedCredential</a></code> objects from a remote <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider②③">Identity Provider</a>.</p>
   <p>This <a data-link-type="dfn">internal method</a> accepts three arguments:</p>
   <dl>
    <dt data-md><dfn class="idl-code" data-dfn-for="FederatedCredential/[[DiscoverFromExternalSource]](origin, options, sameOriginWithAncestors)" data-dfn-type="argument" data-export id="dom-federatedcredential-discoverfromexternalsource-origin-options-sameoriginwithancestors-origin"><code>origin</code><a class="self-link" href="#dom-federatedcredential-discoverfromexternalsource-origin-options-sameoriginwithancestors-origin"></a></dfn>
    <dd data-md>
     <p>This argument is the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin">origin</a>, as determined by the
calling <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#dom-credentialscontainer-get" id="ref-for-dom-credentialscontainer-get">get()</a></code> implementation, i.e., <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#credentialscontainer" id="ref-for-credentialscontainer">CredentialsContainer</a></code>'s <a data-link-type="abstract-op" href="https://w3c.github.io/webappsec-credential-management/#abstract-opdef-request-a-credential" id="ref-for-abstract-opdef-request-a-credential">Request a <code>Credential</code></a> abstract operation.</p>
    <dt data-md><dfn class="idl-code" data-dfn-for="FederatedCredential/[[DiscoverFromExternalSource]](origin, options, sameOriginWithAncestors)" data-dfn-type="argument" data-export id="dom-federatedcredential-discoverfromexternalsource-origin-options-sameoriginwithancestors-options"><code>options</code><a class="self-link" href="#dom-federatedcredential-discoverfromexternalsource-origin-options-sameoriginwithancestors-options"></a></dfn>
    <dd data-md>
     <p>This argument is a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#dictdef-credentialrequestoptions" id="ref-for-dictdef-credentialrequestoptions">CredentialRequestOptions</a></code> object whose <code><var>options</var>.<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#dom-credentialrequestoptions-federated" id="ref-for-dom-credentialrequestoptions-federated">federated</a></code></code> member contains a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#dictdef-federatedcredentialrequestoptions" id="ref-for-dictdef-federatedcredentialrequestoptions③">FederatedCredentialRequestOptions</a></code> object specifying the exchange options.</p>
    <dt data-md><dfn class="idl-code" data-dfn-for="FederatedCredential/[[DiscoverFromExternalSource]](origin, options, sameOriginWithAncestors)" data-dfn-type="argument" data-export id="dom-federatedcredential-discoverfromexternalsource-origin-options-sameoriginwithancestors-sameoriginwithancestors"><code>sameOriginWithAncestors</code><a class="self-link" href="#dom-federatedcredential-discoverfromexternalsource-origin-options-sameoriginwithancestors-sameoriginwithancestors"></a></dfn>
    <dd data-md>
     <p>This argument is a Boolean value which is <code>true</code> if and only if the caller’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a> is <a data-link-type="dfn" href="https://w3c.github.io/webappsec-credential-management/#same-origin-with-its-ancestors" id="ref-for-same-origin-with-its-ancestors">same-origin with its ancestors</a>. It is <code>false</code> if caller is cross-origin.</p>
   </dl>
   <p>When this method is invoked, the user agent MUST execute the following algorithm:</p>
   <ol>
    <li data-md>
     <p>If <var>sameOriginWithAncestors</var> is <code>false</code>, return a "<code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#notallowederror" id="ref-for-notallowederror">NotAllowedError</a></code>" <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code>.</p>
     <p class="note" role="note"><span>Note:</span> This restriction aims to address the concern raised in <a data-link-type="biblio" href="https://w3c.github.io/webappsec-credential-management/#security-origin-confusion"><cite>Security Origin Confusion</cite></a>.</p>
    <li data-md>
     <p class="assertion">Assert: <var>options</var>["<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#dom-credentialrequestoptions-federated" id="ref-for-dom-credentialrequestoptions-federated①">federated</a></code>"]["<code class="idl"><a data-link-type="idl" href="#dom-federatedcredentialrequestoptions-providers" id="ref-for-dom-federatedcredentialrequestoptions-providers">providers</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">exists</a>.</p>
    <li data-md>
     <p class="assertion">Assert: <var>options</var>["<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#dom-credentialrequestoptions-federated" id="ref-for-dom-credentialrequestoptions-federated②">federated</a></code>"]["<code class="idl"><a data-link-type="idl" href="#dom-federatedcredentialrequestoptions-providers" id="ref-for-dom-federatedcredentialrequestoptions-providers①">providers</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size">size</a> is 1.</p>
     <p class="note" role="note"><span>Note:</span> At some point we would like to support choosing accounts from multiple <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider②④">Identity Provider</a>s.</p>
    <li data-md>
     <p>Let <var>provider</var> be <var>options</var>["<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#dom-credentialrequestoptions-federated" id="ref-for-dom-credentialrequestoptions-federated③">federated</a></code>"]["<code class="idl"><a data-link-type="idl" href="#dom-federatedcredentialrequestoptions-providers" id="ref-for-dom-federatedcredentialrequestoptions-providers②">providers</a></code>"][0].</p>
    <li data-md>
     <p class="assertion">Assert: <var>provider</var>["<code class="idl"><a data-link-type="idl" href="#dom-federatedidentityprovider-url" id="ref-for-dom-federatedidentityprovider-url">url</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①">exists</a>.</p>
    <li data-md>
     <p class="assertion">Assert: <var>provider</var>["<code class="idl"><a data-link-type="idl" href="#dom-federatedidentityprovider-clientid" id="ref-for-dom-federatedidentityprovider-clientid">clientId</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②">exists</a>.</p>
    <li data-md>
     <p class="assertion">Assert: <var>provider</var>["<code class="idl"><a data-link-type="idl" href="#dom-federatedidentityprovider-nonce" id="ref-for-dom-federatedidentityprovider-nonce">nonce</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists③">exists</a>.</p>
    <li data-md>
     <p>Let <var>wellknown</var> be the result of running the <a data-link-type="dfn" href="#fetch-the-well-known" id="ref-for-fetch-the-well-known">fetch the well-known</a> algorithm with the <var>provider</var>.</p>
    <li data-md>
     <p>Let <var>accounts list</var> be the result of running the <a data-link-type="dfn" href="#fetch-the-accounts-list" id="ref-for-fetch-the-accounts-list">fetch the accounts list</a> algorithm.</p>
    <li data-md>
     <p>Let <var>account</var> be the result of running the <a data-link-type="dfn" href="#select-an-account" id="ref-for-select-an-account">select an account</a> from the <var>accounts list</var> algorithm.</p>
    <li data-md>
     <p>If the <code class="idl"><a data-link-type="idl" href="#dom-statemachine-account-state" id="ref-for-dom-statemachine-account-state">Account State</a></code> is <a data-link-type="dfn" href="#unregistered" id="ref-for-unregistered①">unregistered</a></p>
     <ol>
      <li data-md>
       <p>Return the result of running the <a data-link-type="dfn" href="#sign-up" id="ref-for-sign-up①">sign-up</a> algorithm.</p>
     </ol>
    <li data-md>
     <p>If the <code class="idl"><a data-link-type="idl" href="#dom-statemachine-session-state" id="ref-for-dom-statemachine-session-state">Session State</a></code> is <a data-link-type="dfn" href="#logged-out" id="ref-for-logged-out①">logged out</a> then</p>
     <ol>
      <li data-md>
       <p>Return the result of running the <a data-link-type="dfn" href="#explicit-sign-in" id="ref-for-explicit-sign-in">explicit sign-in</a> algorithm.</p>
     </ol>
    <li data-md>
     <p>Return the result of running the <a data-link-type="dfn" href="#auto-sign-in" id="ref-for-auto-sign-in">auto sign-in</a> algorithm.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="sign-up">sign-up</dfn> the user run this algorithm:</p>
   <ol>
    <li data-md>
     <p>Gather explicit intent to create an account</p>
    <li data-md>
     <p>Gather explicit agreement with the <a data-link-type="dfn" href="#privacy-policy" id="ref-for-privacy-policy">Privacy Policy</a></p>
    <li data-md>
     <p>Gather explicit agreement with the <a data-link-type="dfn" href="#terms-of-service" id="ref-for-terms-of-service">Terms of Service</a></p>
    <li data-md>
     <p>Set the account’s <code class="idl"><a data-link-type="idl" href="#dom-statemachine-account-state" id="ref-for-dom-statemachine-account-state①">Account State</a></code> from <a data-link-type="dfn" href="#unregistered" id="ref-for-unregistered②">unregistered</a> to <a data-link-type="dfn" href="#registered" id="ref-for-registered①">registered</a>.</p>
    <li data-md>
     <p>Set the account’s <code class="idl"><a data-link-type="idl" href="#dom-statemachine-session-state" id="ref-for-dom-statemachine-session-state①">Session State</a></code> from <a data-link-type="dfn" href="#logged-out" id="ref-for-logged-out②">logged out</a> to <a data-link-type="dfn" href="#logged-in" id="ref-for-logged-in①">logged in</a>.</p>
    <li data-md>
     <p>Return the result of <a data-link-type="dfn">minting</a> a new <a data-link-type="dfn" href="#id-token" id="ref-for-id-token⑤">id token</a>.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="select-an-account">select an account</dfn> from the accounts list run this algorithm:</p>
   <ol>
    <li data-md>
     <p>If <var>accounts list</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size①">size</a> is 1</p>
     <ol>
      <li data-md>
       <p>Let <var>account</var> be <var>accounts list</var>[0]</p>
      <li data-md>
       <p>Return <var>account</var></p>
     </ol>
    <li data-md>
     <p>Display an account chooser</p>
    <li data-md>
     <p>Let <var>account</var> be an account that the user manually selects from the accounts chooser</p>
    <li data-md>
     <p>Return <var>account</var></p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="sign-in①">sign-in</dfn> the user run this algorithm:</p>
   <ol>
    <li data-md>
     <p>Assert that the <code class="idl"><a data-link-type="idl" href="#dom-statemachine-account-state" id="ref-for-dom-statemachine-account-state②">Account State</a></code> is <a data-link-type="dfn" href="#registered" id="ref-for-registered②">registered</a></p>
    <li data-md>
     <p>Set the account’s <code class="idl"><a data-link-type="idl" href="#dom-statemachine-session-state" id="ref-for-dom-statemachine-session-state②">Session State</a></code> from <a data-link-type="dfn" href="#logged-out" id="ref-for-logged-out③">logged out</a> to <a data-link-type="dfn" href="#logged-in" id="ref-for-logged-in②">logged in</a>.</p>
    <li data-md>
     <p>Return the result of <a data-link-type="dfn">minting</a> a new <a data-link-type="dfn" href="#id-token" id="ref-for-id-token⑥">id token</a>.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="auto-sign-in">auto sign-in</dfn> the user run this algorithm:</p>
   <ol>
    <li data-md>
     <p>Return the result of running the <a data-link-type="dfn" href="#sign-in①" id="ref-for-sign-in①">sign-in</a> algorithm.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="explicit-sign-in">explicit sign-in</dfn> the user run this algorithm:</p>
   <ol>
    <li data-md>
     <p>Gather explicit confirmation that the user wants to sign-in to <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party④①">Relying Party</a> with their <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider②⑤">Identity Provider</a>'s <var>account</var></p>
    <li data-md>
     <p>Return the result of running the <a data-link-type="dfn" href="#sign-in①" id="ref-for-sign-in①①">sign-in</a> algorithm.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="fetch-the-well-known">fetch the well-known</dfn> configuration file, run this algorithm:</p>
   <ol>
    <li data-md>
     <p>Let the <var>wellknown url</var> be the relative url ".well-known/webid" of <var>provider</var>["<code class="idl"><a data-link-type="idl" href="#dom-federatedidentityprovider-url" id="ref-for-dom-federatedidentityprovider-url①">url</a></code>"]</p>
    <li data-md>
     <p>Return the result of fetching the <var>wellknown url</var> with the <a href="#Sec-WebID-CSR">Sec-WebID-CSR</a> header but without the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider②⑥">Identity Provider</a>'s cookies.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="fetch-the-accounts-list">fetch the accounts list</dfn> run this algorithm:</p>
   <ol>
    <li data-md>
     <p>Let the <var>acccounts_endpoint</var> url be the relative url <var>wellknown</var>["<code class="idl"><a data-link-type="idl" href="#dom-wellknown-accounts_endpoint" id="ref-for-dom-wellknown-accounts_endpoint">accounts_endpoint</a></code>"] of <var>provider</var>["<code class="idl"><a data-link-type="idl" href="#dom-federatedidentityprovider-url" id="ref-for-dom-federatedidentityprovider-url②">url</a></code>"]</p>
    <li data-md>
     <p>Let the <var>accounts list</var> be the result of fetching the <var>accounts_endpoint</var> with the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider②⑦">Identity Provider</a>'s cookies.</p>
    <li data-md>
     <p>Return the <var>accounts list</var></p>
   </ol>
   <p>To <dfn data-dfn-type="dfn" data-noexport id="fetch-the-client-id-metadata">fetch the client id metadata<a class="self-link" href="#fetch-the-client-id-metadata"></a></dfn> run this algorithm:</p>
   <ol>
    <li data-md>
     <p>Let the <var>client_id_metadata_endpoint</var> url be the relative url <var>wellknown</var>["<code class="idl"><a data-link-type="idl" href="#dom-wellknown-client_id_metadata_endpoint" id="ref-for-dom-wellknown-client_id_metadata_endpoint">client_id_metadata_endpoint</a></code>"] of <var>provider</var>["<code class="idl"><a data-link-type="idl" href="#dom-federatedidentityprovider-url" id="ref-for-dom-federatedidentityprovider-url③">url</a></code>"]</p>
    <li data-md>
     <p>Let the <var>policies</var> be the result of fetching the <var>client_id_metadata_endpoint</var> with the <a href="#Sec-WebID-CSR">Sec-WebID-CSR</a> header but without the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider②⑧">Identity Provider</a>'s cookies.</p>
    <li data-md>
     <p>Return <var>policies</var></p>
   </ol>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="privacy-policy">Privacy Policy</dfn> are the policies described at <code class="idl"><a data-link-type="idl" href="#dom-client_id_metadata_endpont_response-privacy_policy_url" id="ref-for-dom-client_id_metadata_endpont_response-privacy_policy_url">privacy_policy_url</a></code>.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="terms-of-service">Terms of Service</dfn> are the policies described at <code class="idl"><a data-link-type="idl" href="#dom-client_id_metadata_endpont_response-terms_of_service_url" id="ref-for-dom-client_id_metadata_endpont_response-terms_of_service_url">terms_of_service_url</a></code>.</p>
   <p>To <dfn data-dfn-type="dfn" data-noexport id="mint-a-new-id-token">mint a new id token<a class="self-link" href="#mint-a-new-id-token"></a></dfn>, run the following algorithm:</p>
   <ol>
    <li data-md>
     <p>Let <var>token</var> be the result of making a POST request to the <var>wellknown</var>["<code class="idl"><a data-link-type="idl" href="#dom-wellknown-idtoken_endpoint" id="ref-for-dom-wellknown-idtoken_endpoint">idtoken_endpoint</a></code>"] with:</p>
     <ul>
      <li data-md>
       <p>Let the <code class="idl"><a data-link-type="idl" href="#dom-idtoken_endpoint_request-account_id" id="ref-for-dom-idtoken_endpoint_request-account_id">account_id</a></code> be <var>account</var>["<code class="idl"><a data-link-type="idl" href="#dom-accounts_endpoint_response_accounts-account_id" id="ref-for-dom-accounts_endpoint_response_accounts-account_id">account_id</a></code>"].</p>
      <li data-md>
       <p>Let the <code class="idl"><a data-link-type="idl" href="#dom-idtoken_endpoint_request-request" id="ref-for-dom-idtoken_endpoint_request-request">request</a></code> be a new object with</p>
       <ul>
        <li data-md>
         <p>Let <code class="idl"><a data-link-type="idl" href="#dom-idtoken_endpoint_request_request-client_id" id="ref-for-dom-idtoken_endpoint_request_request-client_id">client_id</a></code> be <var>provider</var>["<code class="idl"><a data-link-type="idl" href="#dom-federatedidentityprovider-clientid" id="ref-for-dom-federatedidentityprovider-clientid①">clientId</a></code>"].</p>
        <li data-md>
         <p>Let the <code class="idl"><a data-link-type="idl" href="#dom-idtoken_endpoint_request_request-nonce" id="ref-for-dom-idtoken_endpoint_request_request-nonce">nonce</a></code> be <var>provider</var>["<code class="idl"><a data-link-type="idl" href="#dom-federatedidentityprovider-nonce" id="ref-for-dom-federatedidentityprovider-nonce①">nonce</a></code>"].</p>
       </ul>
     </ul>
    <li data-md>
     <p>Return a new <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential⑦">FederatedCredential</a></code> as:</p>
     <ul>
      <li data-md>
       <p><code class="idl"><a data-link-type="idl">id</a></code> with <var>account</var>["<code class="idl"><a data-link-type="idl" href="#dom-accounts_endpoint_response_accounts-account_id" id="ref-for-dom-accounts_endpoint_response_accounts-account_id①">account_id</a></code>"]</p>
      <li data-md>
       <p><code class="idl"><a data-link-type="idl" href="#dom-federatedcredential-idtoken" id="ref-for-dom-federatedcredential-idtoken①">idToken</a></code> with <var>token</var></p>
      <li data-md>
       <p><code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#dom-federatedcredential-provider" id="ref-for-dom-federatedcredential-provider">provider</a></code> with <var>provider</var>["<code class="idl"><a data-link-type="idl" href="#dom-federatedidentityprovider-url" id="ref-for-dom-federatedidentityprovider-url④">url</a></code>"]</p>
     </ul>
   </ol>
   <h3 class="heading settled" data-level="8.3" id="revocation"><span class="secno">8.3. </span><span class="content">The Revocation API</span><a class="self-link" href="#revocation"></a></h3>
   <p>Whenever the user decides to delete their account on the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party④②">Relying Party</a> the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party④③">Relying Party</a> can call an API to let the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider②⑨">Identity Provider</a> and
the browser know.</p>
   <p>Upon return to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party④④">Relying Party</a>, the user goes through a <a href="#use-cases-sign-up">§ 2.1 Sign-up</a> flow
instead of a <a href="#use-cases-sign-in">§ 2.2 Sign-in</a> flow.</p>
   <div class="example" id="example-bed25357">
    <a class="self-link" href="#example-bed25357"></a> 
<pre class="language-js highlight"><c- k>async</c-> <c- a>function</c-> revoke<c- p>(</c->accountId<c- p>)</c-> <c- p>{</c->
  <c- k>return</c-> <c- k>await</c-> FederatedCredential<c- p>.</c->revoke<c- p>(</c->accountId<c- p>);</c->
<c- p>}</c->
</pre>
   </div>
   <p>This specification extends the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential⑧">FederatedCredential</a></code> interface with an extra static method:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>Window</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext①"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential⑨"><c- g>FederatedCredential</c-></a> : <a data-link-type="idl-name" href="https://w3c.github.io/webappsec-credential-management/#credential" id="ref-for-credential①"><c- n>Credential</c-></a> {
  <c- b>static</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name"><c- n>void</c-></a>> <dfn class="idl-code" data-dfn-for="FederatedCredential" data-dfn-type="method" data-export data-lt="revoke(accountId)" id="dom-federatedcredential-revoke"><code><c- g>revoke</c-></code><a class="self-link" href="#dom-federatedcredential-revoke"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString④"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="FederatedCredential/revoke(accountId)" data-dfn-type="argument" data-export id="dom-federatedcredential-revoke-accountid-accountid"><code><c- g>accountId</c-></code><a class="self-link" href="#dom-federatedcredential-revoke-accountid-accountid"></a></dfn>);
};
</pre>
   <p class="note" role="note"><span>Note:</span> go over the revocation API.</p>
   <h3 class="heading settled" data-level="8.4" id="sign-out"><span class="secno">8.4. </span><span class="content">The Sign-out API</span><a class="self-link" href="#sign-out"></a></h3>
   <h4 class="heading settled" data-level="8.4.1" id="rp-sign-out"><span class="secno">8.4.1. </span><span class="content">RP Sign-out</span><a class="self-link" href="#rp-sign-out"></a></h4>
   <p>When a user wants to log out of their session in the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party④⑤">Relying Party</a>,
the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party④⑥">Relying Party</a> can let the browser know that it wants the <a href="#use-cases-auto-sign-in">§ 2.2.1 Auto Sign-in</a> flow to be disabled, so that the user doesn’t get into an infinite loop.</p>
   <p>It does so by calling the <code>preventSilentAccess()</code> API, which clear the
user’s current account session and takes them to an <a href="#use-cases-explicit-sign-in">§ 2.2.2 Explicit Sign-in</a> flow
whenever the user wants to log back in.</p>
   <div class="example" id="example-bf78b3ca">
    <a class="self-link" href="#example-bf78b3ca"></a> 
<pre class="language-js highlight"><c- a>function</c-> logout<c- p>()</c-> <c- p>{</c->
  navigator<c- p>.</c->credentials<c- p>.</c->preventSilentAccess<c- p>();</c->
<c- p>}</c->
</pre>
   </div>
   <p class="note" role="note"><span>Note:</span> go over the RP sign-out API.</p>
   <h4 class="heading settled" data-level="8.4.2" id="idp-sign-out"><span class="secno">8.4.2. </span><span class="content">IDP Sign-out</span><a class="self-link" href="#idp-sign-out"></a></h4>
   <p>In enterprise scenarios, it is common for the user to want to clear all of
their existing sessions in all of the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party④⑦">Relying Party</a>s they are logged into.</p>
   <p>It does so by being navigated to their <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider③⓪">Identity Provider</a> who initiates
what’s called a <a data-link-type="biblio" href="https://openid.net/specs/openid-connect-frontchannel-1_0.html"><cite>Front-Channel Logout</cite></a>.</p>
   <p>The browser exposes an API that takes the list of <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party④⑧">Relying Party</a>s that the <a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider③①">Identity Provider</a> wants to initiate the logout which are loaded in parallel
with cookies.</p>
   <p>Each <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party④⑨">Relying Party</a> endpoint is responsible for clearing its local state
(e.g. clearing cookies).</p>
   <p>After the completion of this API, the user’s session is cleared and will go
through an <a href="#use-cases-explicit-sign-in">§ 2.2.2 Explicit Sign-in</a> upon return.</p>
   <div class="example" id="example-ec30aec2">
    <a class="self-link" href="#example-ec30aec2"></a> 
<pre class="language-js highlight"><c- k>async</c-> <c- a>function</c-> logout<c- p>()</c-> <c- p>{</c->
  <c- k>await</c-> FederatedCredential<c- p>.</c->logout<c- p>([{</c->
      endpoint<c- o>:</c-> <c- u>"https://rp1.example"</c-><c- p>,</c->
      accountId<c- o>:</c-> <c- u>"123"</c-><c- p>,</c->
    <c- p>},</c-> <c- p>{</c->
      endpiont<c- o>:</c-> <c- u>"https://rpN.example"</c-><c- p>,</c->
      accountId<c- o>:</c-> <c- u>"456"</c-><c- p>,</c->
    <c- p>}]);</c->
<c- p>}</c->
</pre>
   </div>
   <p><a data-link-type="dfn" href="#idp" id="ref-for-idp①④">IDP</a>s can call <code><a data-link-type="idl">FederatedCredential.logout(...)</a></code> to log the user out of the <a data-link-type="dfn" href="#rp" id="ref-for-rp①⑧">RP</a>s they are signed into.</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-webidlogoutrequest"><code><c- g>WebIdLogoutRequest</c-></code></dfn> {
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑤"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="WebIdLogoutRequest" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-webidlogoutrequest-endpoint"><code><c- g>endpoint</c-></code><a class="self-link" href="#dom-webidlogoutrequest-endpoint"></a></dfn>;
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑥"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="WebIdLogoutRequest" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-webidlogoutrequest-accountid"><code><c- g>accountId</c-></code><a class="self-link" href="#dom-webidlogoutrequest-accountid"></a></dfn>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=<c- n>Window</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext②"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential①⓪"><c- g>FederatedCredential</c-></a> : <a data-link-type="idl-name" href="https://w3c.github.io/webappsec-credential-management/#credential" id="ref-for-credential②"><c- n>Credential</c-></a> {
  <c- b>static</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name"><c- n>void</c-></a>> <dfn class="idl-code" data-dfn-for="FederatedCredential" data-dfn-type="method" data-export data-lt="logout(logout_requests)|logout()" id="dom-federatedcredential-logout"><code><c- g>logout</c-></code><a class="self-link" href="#dom-federatedcredential-logout"></a></dfn>(<c- b>optional</c-> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence" id="ref-for-idl-sequence①"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-webidlogoutrequest" id="ref-for-dictdef-webidlogoutrequest"><c- n>WebIdLogoutRequest</c-></a>> <dfn class="idl-code" data-dfn-for="FederatedCredential/logout(logout_requests), FederatedCredential/logout()" data-dfn-type="argument" data-export id="dom-federatedcredential-logout-logout_requests-logout_requests"><code><c- g>logout_requests</c-></code><a class="self-link" href="#dom-federatedcredential-logout-logout_requests-logout_requests"></a></dfn> = []);
};
</pre>
   <p class="note" role="note"><span>Note:</span> go over how this is implemented.</p>
   <h3 class="heading settled" data-level="8.5" id="backwards-compatibility"><span class="secno">8.5. </span><span class="content">Backwards Compatibility</span><a class="self-link" href="#backwards-compatibility"></a></h3>
   <h4 class="heading settled" data-level="8.5.1" id="Interceptors"><span class="secno">8.5.1. </span><span class="content">Interceptors</span><a class="self-link" href="#Interceptors"></a></h4>
   <p class="note" role="note"><span>Note:</span> go over how interceptors work.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed③"><c- g>Exposed</c-></a>=<c- n>Window</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext③"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential" id="ref-for-federatedcredential①①"><c- g>FederatedCredential</c-></a> : <a data-link-type="idl-name" href="https://w3c.github.io/webappsec-credential-management/#credential" id="ref-for-credential③"><c- n>Credential</c-></a> {
  <c- b>static</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise②"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name"><c- n>void</c-></a>> <dfn class="idl-code" data-dfn-for="FederatedCredential" data-dfn-type="method" data-export data-lt="registerInterceptor(interceptor)" id="dom-federatedcredential-registerinterceptor"><code><c- g>registerInterceptor</c-></code><a class="self-link" href="#dom-federatedcredential-registerinterceptor"></a></dfn>(<a data-link-type="idl-name" href="#dictdef-federatedcredentialinterceptor" id="ref-for-dictdef-federatedcredentialinterceptor"><c- n>FederatedCredentialInterceptor</c-></a> <dfn class="idl-code" data-dfn-for="FederatedCredential/registerInterceptor(interceptor)" data-dfn-type="argument" data-export id="dom-federatedcredential-registerinterceptor-interceptor-interceptor"><code><c- g>interceptor</c-></code><a class="self-link" href="#dom-federatedcredential-registerinterceptor-interceptor-interceptor"></a></dfn>);
};
</pre>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-federatedcredentialinterceptor"><code><c- g>FederatedCredentialInterceptor</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString " href="#dom-federatedcredentialinterceptor-url" id="ref-for-dom-federatedcredentialinterceptor-url"><c- g>url</c-></a>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence" id="ref-for-idl-sequence②"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a>> <a class="idl-code" data-link-type="dict-member" data-type="sequence<DOMString> " href="#dom-federatedcredentialinterceptor-params" id="ref-for-dom-federatedcredentialinterceptor-params"><c- g>params</c-></a>;
};
</pre>
   <div>
    <dl>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="FederatedCredentialInterceptor" data-dfn-type="dict-member" data-export id="dom-federatedcredentialinterceptor-url"><code>url</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString③">DOMString</a></span>
     <dd data-md>
      <p>The url that points the browser to the .well-known configuration file.</p>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="FederatedCredentialInterceptor" data-dfn-type="dict-member" data-export id="dom-federatedcredentialinterceptor-params"><code>params</code></dfn>, <span> of type sequence&lt;<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString④">DOMString</a>></span>
     <dd data-md>
      <p>The URL request parameters to intercept navigations.</p>
    </dl>
   </div>
   <h2 class="heading settled" data-level="9" id="security"><span class="secno">9. </span><span class="content">Security</span><a class="self-link" href="#security"></a></h2>
   <p class="note" role="note"><span>Note:</span> go over security.</p>
   <h2 class="heading settled" data-level="10" id="privacy"><span class="secno">10. </span><span class="content">Privacy</span><a class="self-link" href="#privacy"></a></h2>
   <p class="note" role="note"><span>Note:</span> go over privacy.</p>
   <h3 class="heading settled" data-level="10.1" id="privacy-threat-model"><span class="secno">10.1. </span><span class="content">Privacy Threat Model</span><a class="self-link" href="#privacy-threat-model"></a></h3>
   <p>This section is intended to provide a comprehensive overview of the privacy risks associated with federated identity on the web for the purpose of measuring the privacy risks and benefits of proposed browser intermediation designs.</p>
   <h4 class="heading settled" data-level="10.1.1" id="principals"><span class="secno">10.1.1. </span><span class="content">Principals</span><a class="self-link" href="#principals"></a></h4>
   <p>This section describes the three principals that would participate in an invocation of the API and expectations around their behavior.</p>
   <ol>
    <li data-md>
     <p>The <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent">User Agent</a> implements the API and controls the execution contexts for the RP and IDP content. The user agent is assumed to be trusted by the user, and transitively trusted by the RP and IDP.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party⑤⓪">Relying Party</a>s are first party websites that invoke the WebID API for the purpose of authenticating a user to their account or for requesting information about that user. A well-behaving RP would only invoke the API following a clear user signal -- typically, clicking a sign-in button. Since any site can invoke the API, RPs cannot necessarily be trusted to limit the user information it collects or use that information in an acceptable way.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="#identity-provider" id="ref-for-identity-provider③②">Identity Provider</a>s are third party websites that are the target of a WebID call to attempt to fetch an ID token. Usually the IDP has a higher level of trust than the RP since it already has the user’s personal information, but it is possible that the IDP might use the user’s information in non-approved ways. It is possible that the IDP specified in the API call may not be an IDP the user knows about, or may not be a bona fide IDP at all, in which case it likely does not have personal user information in advance, but also might be less accountable for its behavior.</p>
   </ol>
   <h4 class="heading settled" data-level="10.1.2" id="attack-scenarios"><span class="secno">10.1.2. </span><span class="content">Attack Scenarios</span><a class="self-link" href="#attack-scenarios"></a></h4>
   <p>This section describes the scenarios in which various agents might attempt to gain user information. It considers the possibilities when the RP is collecting information, the IDP is collecting information, or both the RP and the IDP are colluding. For the purposes of this section, a principal is considered to be participating in the collection of information if it directly or indirectly performs actions with the aim of realizing one of the above threats.</p>
   <p class="note" role="note"><span>Note:</span> An example of indirect collusion would be an RP importing a script supplied by an IDP where the IDP intends to track users.</p>
   <p>For the purpose of discussion this document assumes that third-party cookies are <strong>disabled</strong> by default and are no longer effective for use in tracking mechanisms, and also some form of mitigations are implemented against ‘bounce tracking’ using link decoration or postMessage. Most of these scenarios consider how user tracking might happen <strong>without</strong> them.</p>
   <h5 class="heading settled" data-level="10.1.2.1" id="relying-party-collecting-information"><span class="secno">10.1.2.1. </span><span class="content">Relying Party collecting information</span><a class="self-link" href="#relying-party-collecting-information"></a></h5>
   <h6 class="heading settled" data-level="10.1.2.1.1" id="-rp1-multiple-relying-parties-correlate-user-information-for-tracking-purposes"><span class="secno">10.1.2.1.1. </span><span class="content">(<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="rp1">RP1</dfn>) Multiple Relying Parties correlate user information for tracking purposes</span><a class="self-link" href="#-rp1-multiple-relying-parties-correlate-user-information-for-tracking-purposes"></a></h6>
   <p>When a user willingly provides their full name, email address, phone number, etc, to multiple relying parties, those relying parties can collaborate to build a profile of that user and their activity across collaborating sites. This correlation and profile-building is outside the user’s control and entirely out of the browser’s or IDP’s view.</p>
   <h6 class="heading settled" data-level="10.1.2.1.2" id="-rp2-relying-party-obtains-personal-user-information-from-idp-without-user-consent"><span class="secno">10.1.2.1.2. </span><span class="content">(<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="rp2">RP2</dfn>) Relying Party obtains personal user information from IDP without user consent</span><a class="self-link" href="#-rp2-relying-party-obtains-personal-user-information-from-idp-without-user-consent"></a></h6>
   <p>A relying party might attempt to obtain user information from an identity provider without the user having consenting to the information being released, or being aware of it being released. This can happen if consent mechanisms are missing, inadequate, or susceptible to bypass.</p>
   <h6 class="heading settled" data-level="10.1.2.1.3" id="-rp3-relying-party-uses-user-information-for-purposes-to-which-the-user-did-not-consent"><span class="secno">10.1.2.1.3. </span><span class="content">(<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="rp3">RP3</dfn>) Relying Party uses user information for purposes to which the user did not consent</span><a class="self-link" href="#-rp3-relying-party-uses-user-information-for-purposes-to-which-the-user-did-not-consent"></a></h6>
   <p>When the user agrees to allow the IDP to provide information to the RP, the consent is specific to specific purposes, such as sign-in and personalization. The RP might use that data for other purposes, such as selling email addresses to a spam list. Spamming risk can exist even when using <a href="#directed-identifiers">directed identifiers</a>.</p>
   <h6 class="heading settled" data-level="10.1.2.1.4" id="-rp4-relying-party-employs-client-state-based-tracking-to-identify-user"><span class="secno">10.1.2.1.4. </span><span class="content">(<dfn data-dfn-type="dfn" data-noexport id="rp4">RP4<a class="self-link" href="#rp4"></a></dfn>) Relying Party employs client state-based tracking to identify user</span><a class="self-link" href="#-rp4-relying-party-employs-client-state-based-tracking-to-identify-user"></a></h6>
   <p>Any API that exposes any kind of client state to the web risk becoming a vector for fingerprinting or ‘supercookies’. Neither the status quo of federated identity nor current proposals for browser mediation add detectable client state that would increase fingerprinting risk, but any changes or additional features need to be analyzed as to whether they increase the feasibility of sites tracking users without cookies.</p>
   <h5 class="heading settled" data-level="10.1.2.2" id="identity-provider-collecting-information"><span class="secno">10.1.2.2. </span><span class="content">Identity Provider collecting information</span><a class="self-link" href="#identity-provider-collecting-information"></a></h5>
   <h6 class="heading settled" data-level="10.1.2.2.1" id="-idp1-identity-provider-tracking-user-sign-ins-to-relying-party-sites"><span class="secno">10.1.2.2.1. </span><span class="content">(<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="idp1">IDP1</dfn>) Identity Provider tracking user sign-ins to Relying Party sites</span><a class="self-link" href="#-idp1-identity-provider-tracking-user-sign-ins-to-relying-party-sites"></a></h6>
    Existing federation protocols require that the Identity Provider know the CLIENT_ID of the Relying Party in order to allow identity federation. Identity providers can use this fact to build profiles of users across sites where the user has decided to use federation with the same account. This profile could be used, for example, to serve targeted advertisements to those users browsing on sites that the IDP controls. 
   <p>This risk can exist even in the case where the IDP does not having pre-existing user account information (for instance, if it is not a _bona fide_ IDP), because WebID requests sent to the IDP are credentialed. This is more likely to occur if the RP is colluding with the IDP to enable tracking; expanded variants are described in <a href="#col2-rp-sharing-user-identifying-information-with-the-idp">COL2</a>.</p>
   <h6 class="heading settled" data-level="10.1.2.2.2" id="-idp2-identity-provider-misusing-federated-sign-in-capabilities"><span class="secno">10.1.2.2.2. </span><span class="content">(<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="idp2">IDP2</dfn>) Identity Provider misusing federated sign-in capabilities</span><a class="self-link" href="#-idp2-identity-provider-misusing-federated-sign-in-capabilities"></a></h6>
    Since Identity Providers have unconstrained ability to issue ID tokens, they are capable of logging in to users’ federated accounts without user knowledge or action. 
   <h5 class="heading settled" data-level="10.1.2.3" id="relying-party-and-identity-provider-colluding-to-collect-information"><span class="secno">10.1.2.3. </span><span class="content">Relying Party and Identity Provider colluding to collect information</span><a class="self-link" href="#relying-party-and-identity-provider-colluding-to-collect-information"></a></h5>
   <h6 class="heading settled" data-level="10.1.2.3.1" id="-col1-idp-exceeding-users-information-sharing-permission"><span class="secno">10.1.2.3.1. </span><span class="content">(<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="col1">COL1</dfn>) IDP exceeding user’s information sharing permission</span><a class="self-link" href="#-col1-idp-exceeding-users-information-sharing-permission"></a></h6>
    Existing federated identity protocols are clear on what information an RP is requesting, which the IDP can provide. While the browser can inspect the request and response and consider whether user permission has been granted for that transfer, it is difficult to know that there is no additional information embedded in the response. An example could be if the IDP encodes an identifier that could be used to load user-targeted advertisements on RP pages, which could be of value where the IDP has much more profiling information about the user. Another example is if the ID token is shared out-of-band, invisible to the browser, in which case it could contain anything. 
   <h6 class="heading settled" data-level="10.1.2.3.2" id="-col2-rp-sharing-user-identifying-information-with-the-idp"><span class="secno">10.1.2.3.2. </span><span class="content">(<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="col2">COL2</dfn>) RP sharing user-identifying information with the IDP</span><a class="self-link" href="#-col2-rp-sharing-user-identifying-information-with-the-idp"></a></h6>
   <p>The potential for IDPs profiling users based on their visits to RPs (described in <a data-link-type="dfn" href="#idp1" id="ref-for-idp1">IDP1</a>) can be partially mitigated by hiding the RP from the IDP until after the user has consented to that tracking risk. However, there is residual risk in cases where the RP and IDP are colluding.</p>
   <p>If a credentialed request is sent to the IDP that does not explicitly identify the RP, either of the following would still allow tracking by the IDP (again, possibly not a _bona fide_ IDP that has existing knowledge of the user):</p>
   <ul>
    <li data-md>
     <p>The RP controlling any field in the request that can be used to convey identifying data in the request that the IDP could correlate to other requests from other RPs;</p>
    <li data-md>
     <p>The RP being able to provide fine-resolution timing information about the request to the IDP out of band.</p>
   </ul>
   <p>The timing information can enable tracking in the following way: The RP logs the time at which it invoked the API, and the IDP logs the time at which it received a credentialed WebID request from the user, and later they attempt to link the invocation and the request together using that information. Notably, this is possible without WebID using simple cross-origin top-level navigations, but using WebID for this purpose would worsen the problem if it improved timing resolution or was less visible to users.</p>
   <h4 class="heading settled" data-level="10.1.3" id="mitigation"><span class="secno">10.1.3. </span><span class="content">Mitigation</span><a class="self-link" href="#mitigation"></a></h4>
   <h5 class="heading settled" data-level="10.1.3.1" id="directed-identifiers"><span class="secno">10.1.3.1. </span><span class="content">Directed identifiers</span><a class="self-link" href="#directed-identifiers"></a></h5>
   <ul>
    <li data-md>
     <p>Mitigates: <a data-link-type="dfn" href="#rp1" id="ref-for-rp1">RP1</a></p>
   </ul>
   <p>The problem of RPs joining user data via back-channels is inherent to the proliferation of identifying user data. This can be solved by issuing ‘directed’ identifiers that provide an effective handle to a user’s identity with a given IDP that is unique and therefore cannot be correlated with other RPs. The term ‘directed’ implies that it is unidirectionally identifying, such as in a directed graph. In the past, there have been schemes to accomplish this using one-way hashes of, for example, the user’s name, the IDP and the RP. Notably, this mitigation is not robust against collusion from between the IDP and the RP, or the IDP participating in tracking itself. Also, collaborating RPs might be able to defeat this mitigation by sharing the same CLIENT_ID, although possibly this could be detected and presumably would violate RP agreements with IDPs.</p>
   <h5 class="heading settled" data-level="10.1.3.2" id="browser-enforced-consent"><span class="secno">10.1.3.2. </span><span class="content">Browser-enforced consent</span><a class="self-link" href="#browser-enforced-consent"></a></h5>
   <ul>
    <li data-md>
     <p>Mitigates: <a data-link-type="dfn" href="#rp2" id="ref-for-rp2">RP2</a>, <a data-link-type="dfn" href="#idp1" id="ref-for-idp1①">IDP1</a>, <a data-link-type="dfn" href="#col2" id="ref-for-col2">COL2</a></p>
   </ul>
   <p>IDPs, whom the user has entrusted with their personal data, are currently responsible for ensuring that the user consents to their information being shared. With browser mediation in place, the user agent might have to assume responsibility for ensuring the user understands what is being shared and that it is intentional. This is certainly the case if the browser is able to entirely intermediate the identity flow without showing any IDP web content, but also might be desirable if there are concerns that the IDP is not collecting consent in an adequate manner.
Additionally, a consent prompt preceding the sharing of the RP’s request to the IDP can mitigate risks around IDP tracking of user visits to RPs.</p>
   <h5 class="heading settled" data-level="10.1.3.3" id="identity-provider-policy"><span class="secno">10.1.3.3. </span><span class="content">Identity Provider policy</span><a class="self-link" href="#identity-provider-policy"></a></h5>
   <ul>
    <li data-md>
     <p>Mitigates: <a data-link-type="dfn" href="#idp2" id="ref-for-idp2">IDP2</a>, <a data-link-type="dfn" href="#col1" id="ref-for-col1">COL1</a></p>
   </ul>
   <p>Beyond technical constraints, the browser can recognize explicit assertions by the IDP about the privacy characteristics it provides and rely on those assertions in order to guide the user appropriately. An example is a hypothetical case in which the IDP asserts it will only issue directed identifiers and will not provide identifying information to the RPs out of view of the browser. In that case the browser may not have to warn the user about sharing personalized information.</p>
   <h5 class="heading settled" data-level="10.1.3.4" id="denylists"><span class="secno">10.1.3.4. </span><span class="content">Denylists</span><a class="self-link" href="#denylists"></a></h5>
   <ul>
    <li data-md>
     <p>Mitigates: Potentially all threats, but is subject to the likelihood of bad behavior being detected, which for some might be difficult.</p>
   </ul>
   <p>Any RPs or IDPs observed to be using this API to compromise user privacy in a deceptive or abusive manner could be explicitly blocked from using it, or potentially added to the SafeBrowsing blocklist so that they cannot be loaded at all.</p>
   <h5 class="heading settled" data-level="10.1.3.5" id="hiding-the-rp-from-the-idp"><span class="secno">10.1.3.5. </span><span class="content">Hiding the RP from the IDP</span><a class="self-link" href="#hiding-the-rp-from-the-idp"></a></h5>
   <ul>
    <li data-md>
     <p>Mitigates: <a data-link-type="dfn" href="#idp1" id="ref-for-idp1②">IDP1</a>, <a data-link-type="dfn" href="#col2" id="ref-for-col2①">COL2</a></p>
   </ul>
   <p>Preventing tracking of users by the IDP is difficult because the RP has to be coded into the identity token for security reasons, to prevent reuse of the token. There have been cryptographic schemes developed to blind the IDP to the RP while still preventing token reuse in that way (see Mozilla’s <a href="https://wiki.mozilla.org/Identity/Persona_AAR">personas</a>) but there are other valid uses that the IDP has for knowing the RP, such as fraud and abuse prevention. Also, it may conflict with <a href="#directed-identifiers">directed identifiers</a>, since the IDP has to have the ability to map RP+User → directed ID.</p>
   <h5 class="heading settled" data-level="10.1.3.6" id="identity-provider-has-a-relationship-with-the-rp"><span class="secno">10.1.3.6. </span><span class="content">Identity Provider has a relationship with the RP</span><a class="self-link" href="#identity-provider-has-a-relationship-with-the-rp"></a></h5>
   <ul>
    <li data-md>
     <p>Mitigates: <a data-link-type="dfn" href="#rp2" id="ref-for-rp2①">RP2</a>, <a data-link-type="dfn" href="#rp3" id="ref-for-rp3">RP3</a></p>
   </ul>
   <p>Currently, IDPs require that an RP agree to specific terms before the IDP will issue an ID token to them. This conflicts with <a href="#Hiding-the-RP-from-the-IDP">the previous mitigation</a>, but can provide a measure of RP accountability.</p>
   <h4 class="heading settled" data-level="10.1.4" id="related-reading"><span class="secno">10.1.4. </span><span class="content">Related reading</span><a class="self-link" href="#related-reading"></a></h4>
   <ul>
    <li data-md>
     <p><a href="https://github.com/michaelkleber/privacy-model">A Potential Privacy Model for the Web</a></p>
    <li data-md>
     <p><a href="https://w3cping.github.io/privacy-threat-model/">Editor’s Draft for a Web Privacy Threat Model</a></p>
    <li data-md>
     <p><a href="https://docs.oasis-open.org/security/saml/v2.0/saml-sec-consider-2.0-os.pdf">Security and Privacy Considerations for SAML V2.0</a></p>
   </ul>
   <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
   <p class="note" role="note"><span>Note:</span> write down the Acknowledgements section.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note. </p>
   <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
   <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
  </div>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#account">account</a><span>, in § 4</span>
   <li><a href="#dom-webidlogoutrequest-accountid">accountId</a><span>, in § 8.4.2</span>
   <li><a href="#account-json">Account JSON</a><span>, in § 6.2</span>
   <li><a href="#dom-federatedcredential-approvedby">approvedBy</a><span>, in § 8.2</span>
   <li><a href="#dom-federatedcredentialapprovedby-auto">"auto"</a><span>, in § 8.2</span>
   <li><a href="#auto-sign-in">auto sign-in</a><span>, in § 8.2</span>
   <li><a href="#dom-federatedidentityprovider-clientid">clientId</a><span>, in § 8.2</span>
   <li><a href="#col1">COL1</a><span>, in § 10.1.2.3.1</span>
   <li><a href="#col2">COL2</a><span>, in § 10.1.2.3.2</span>
   <li><a href="#dom-federatedcredential-discoverfromexternalsource-slot">[[DiscoverFromExternalSource]]()</a><span>, in § 8.2</span>
   <li><a href="#dom-federatedcredential-discoverfromexternalsource-origin-options-sameoriginwithancestors-slot">[[DiscoverFromExternalSource]](origin, options, sameOriginWithAncestors)</a><span>, in § 8.2</span>
   <li><a href="#dom-webidlogoutrequest-endpoint">endpoint</a><span>, in § 8.4.2</span>
   <li><a href="#explicit-sign-in">explicit sign-in</a><span>, in § 8.2</span>
   <li><a href="#enumdef-federatedcredentialapprovedby">FederatedCredentialApprovedBy</a><span>, in § 8.2</span>
   <li><a href="#dictdef-federatedcredentialinterceptor">FederatedCredentialInterceptor</a><span>, in § 8.5.1</span>
   <li><a href="#dictdef-federatedidentityprovider">FederatedIdentityProvider</a><span>, in § 8.2</span>
   <li><a href="#fetch-the-accounts-list">fetch the accounts list</a><span>, in § 8.2</span>
   <li><a href="#fetch-the-client-id-metadata">fetch the client id metadata</a><span>, in § 8.2</span>
   <li><a href="#fetch-the-well-known">fetch the well-known</a><span>, in § 8.2</span>
   <li><a href="#high-level-api">high-level API</a><span>, in § 4</span>
   <li><a href="#identity-provider">Identity Provider</a><span>, in § 4</span>
   <li><a href="#idp">IDP</a><span>, in § 4</span>
   <li><a href="#idp1">IDP1</a><span>, in § 10.1.2.2.1</span>
   <li><a href="#idp2">IDP2</a><span>, in § 10.1.2.2.2</span>
   <li><a href="#id-token">id token</a><span>, in § 4</span>
   <li><a href="#dom-federatedcredential-idtoken">idToken</a><span>, in § 8.2</span>
   <li><a href="#logged-in">logged in</a><span>, in § 4</span>
   <li><a href="#logged-out">logged out</a><span>, in § 4</span>
   <li><a href="#dom-federatedcredential-logout">logout()</a><span>, in § 8.4.2</span>
   <li><a href="#dom-federatedcredential-logout">logout(logout_requests)</a><span>, in § 8.4.2</span>
   <li><a href="#low-level-api">low-level API</a><span>, in § 4</span>
   <li><a href="#mint-a-new-id-token">mint a new id token</a><span>, in § 8.2</span>
   <li><a href="#dom-federatedidentityprovider-nonce">nonce</a><span>, in § 8.2</span>
   <li><a href="#out-of-band">out-of-band</a><span>, in § 4</span>
   <li><a href="#dom-federatedcredentialinterceptor-params">params</a><span>, in § 8.5.1</span>
   <li><a href="#privacy-policy">Privacy Policy</a><span>, in § 8.2</span>
   <li><a href="#dom-federatedcredentialrequestoptions-providers">providers</a><span>, in § 8.2</span>
   <li><a href="#registered">registered</a><span>, in § 4</span>
   <li><a href="#dom-federatedcredential-registerinterceptor">registerInterceptor(interceptor)</a><span>, in § 8.5.1</span>
   <li><a href="#relying-party">Relying Party</a><span>, in § 4</span>
   <li><a href="#dom-federatedcredential-revoke">revoke(accountId)</a><span>, in § 8.3</span>
   <li><a href="#rp">RP</a><span>, in § 4</span>
   <li><a href="#rp1">RP1</a><span>, in § 10.1.2.1.1</span>
   <li><a href="#rp2">RP2</a><span>, in § 10.1.2.1.2</span>
   <li><a href="#rp3">RP3</a><span>, in § 10.1.2.1.3</span>
   <li><a href="#rp4">RP4</a><span>, in § 10.1.2.1.4</span>
   <li><a href="#rp-request">RP request</a><span>, in § 6.4</span>
   <li><a href="#sec-webid-csr">Sec-WebID-CSR</a><span>, in § 6.6</span>
   <li><a href="#select-an-account">select an account</a><span>, in § 8.2</span>
   <li><a href="#session">session</a><span>, in § 4</span>
   <li><a href="#sign-in①">sign-in</a><span>, in § 8.2</span>
   <li><a href="#sign-up">sign-up</a><span>, in § 8.2</span>
   <li><a href="#terms-of-service">Terms of Service</a><span>, in § 8.2</span>
   <li><a href="#unregistered">unregistered</a><span>, in § 4</span>
   <li>
    url
    <ul>
     <li><a href="#dom-federatedcredentialinterceptor-url">dict-member for FederatedCredentialInterceptor</a><span>, in § 8.5.1</span>
     <li><a href="#dom-federatedidentityprovider-url">dict-member for FederatedIdentityProvider</a><span>, in § 8.2</span>
    </ul>
   <li><a href="#dom-federatedcredentialapprovedby-user">"user"</a><span>, in § 8.2</span>
   <li><a href="#dictdef-webidlogoutrequest">WebIdLogoutRequest</a><span>, in § 8.4.2</span>
   <li><a href="#website">Website</a><span>, in § 4</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-credential">
   <a href="https://w3c.github.io/webappsec-credential-management/#credential">https://w3c.github.io/webappsec-credential-management/#credential</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-credential">8.2. The Sign-in API</a>
    <li><a href="#ref-for-credential①">8.3. The Revocation API</a>
    <li><a href="#ref-for-credential②">8.4.2. IDP Sign-out</a>
    <li><a href="#ref-for-credential③">8.5.1. Interceptors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dictdef-credentialrequestoptions">
   <a href="https://w3c.github.io/webappsec-credential-management/#dictdef-credentialrequestoptions">https://w3c.github.io/webappsec-credential-management/#dictdef-credentialrequestoptions</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-credentialrequestoptions">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-credentialscontainer">
   <a href="https://w3c.github.io/webappsec-credential-management/#credentialscontainer">https://w3c.github.io/webappsec-credential-management/#credentialscontainer</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-credentialscontainer">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-federatedcredential">
   <a href="https://w3c.github.io/webappsec-credential-management/#federatedcredential">https://w3c.github.io/webappsec-credential-management/#federatedcredential</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-federatedcredential">3. Examples</a>
    <li><a href="#ref-for-federatedcredential①">8.2. The Sign-in API</a> <a href="#ref-for-federatedcredential②">(2)</a> <a href="#ref-for-federatedcredential③">(3)</a> <a href="#ref-for-federatedcredential④">(4)</a> <a href="#ref-for-federatedcredential⑤">(5)</a> <a href="#ref-for-federatedcredential⑥">(6)</a> <a href="#ref-for-federatedcredential⑦">(7)</a>
    <li><a href="#ref-for-federatedcredential⑧">8.3. The Revocation API</a> <a href="#ref-for-federatedcredential⑨">(2)</a>
    <li><a href="#ref-for-federatedcredential①⓪">8.4.2. IDP Sign-out</a>
    <li><a href="#ref-for-federatedcredential①①">8.5.1. Interceptors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dictdef-federatedcredentialrequestoptions">
   <a href="https://w3c.github.io/webappsec-credential-management/#dictdef-federatedcredentialrequestoptions">https://w3c.github.io/webappsec-credential-management/#dictdef-federatedcredentialrequestoptions</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-federatedcredentialrequestoptions">8.2. The Sign-in API</a> <a href="#ref-for-dictdef-federatedcredentialrequestoptions①">(2)</a> <a href="#ref-for-dictdef-federatedcredentialrequestoptions②">(3)</a> <a href="#ref-for-dictdef-federatedcredentialrequestoptions③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-abstract-opdef-request-a-credential">
   <a href="https://w3c.github.io/webappsec-credential-management/#abstract-opdef-request-a-credential">https://w3c.github.io/webappsec-credential-management/#abstract-opdef-request-a-credential</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-request-a-credential">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-credentialrequestoptions-federated">
   <a href="https://w3c.github.io/webappsec-credential-management/#dom-credentialrequestoptions-federated">https://w3c.github.io/webappsec-credential-management/#dom-credentialrequestoptions-federated</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-credentialrequestoptions-federated">8.2. The Sign-in API</a> <a href="#ref-for-dom-credentialrequestoptions-federated①">(2)</a> <a href="#ref-for-dom-credentialrequestoptions-federated②">(3)</a> <a href="#ref-for-dom-credentialrequestoptions-federated③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-credentialscontainer-get">
   <a href="https://w3c.github.io/webappsec-credential-management/#dom-credentialscontainer-get">https://w3c.github.io/webappsec-credential-management/#dom-credentialscontainer-get</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-credentialscontainer-get">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-credentialrequestoptions-mediation">
   <a href="https://w3c.github.io/webappsec-credential-management/#dom-credentialrequestoptions-mediation">https://w3c.github.io/webappsec-credential-management/#dom-credentialrequestoptions-mediation</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-credentialrequestoptions-mediation">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-federatedcredential-provider">
   <a href="https://w3c.github.io/webappsec-credential-management/#dom-federatedcredential-provider">https://w3c.github.io/webappsec-credential-management/#dom-federatedcredential-provider</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-federatedcredential-provider">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-same-origin-with-its-ancestors">
   <a href="https://w3c.github.io/webappsec-credential-management/#same-origin-with-its-ancestors">https://w3c.github.io/webappsec-credential-management/#same-origin-with-its-ancestors</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-same-origin-with-its-ancestors">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-environment-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-environment-settings-object">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-origin">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-settings-object-origin">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-relevant-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relevant-settings-object">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-exists">
   <a href="https://infra.spec.whatwg.org/#map-exists">https://infra.spec.whatwg.org/#map-exists</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-exists">8.2. The Sign-in API</a> <a href="#ref-for-map-exists①">(2)</a> <a href="#ref-for-map-exists②">(3)</a> <a href="#ref-for-map-exists③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-size">
   <a href="https://infra.spec.whatwg.org/#list-size">https://infra.spec.whatwg.org/#list-size</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-size">8.2. The Sign-in API</a> <a href="#ref-for-list-size①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-user-agent">
   <a href="https://infra.spec.whatwg.org/#user-agent">https://infra.spec.whatwg.org/#user-agent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-agent">10.1.1. Principals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMException">
   <a href="https://heycam.github.io/webidl/#idl-DOMException">https://heycam.github.io/webidl/#idl-DOMException</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMException">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMString">
   <a href="https://heycam.github.io/webidl/#idl-DOMString">https://heycam.github.io/webidl/#idl-DOMString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMString">8.2. The Sign-in API</a>
    <li><a href="#ref-for-idl-DOMString①">8.5.1. Interceptors</a> <a href="#ref-for-idl-DOMString②">(2)</a> <a href="#ref-for-idl-DOMString③">(3)</a> <a href="#ref-for-idl-DOMString④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Exposed">
   <a href="https://heycam.github.io/webidl/#Exposed">https://heycam.github.io/webidl/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">8.2. The Sign-in API</a>
    <li><a href="#ref-for-Exposed①">8.3. The Revocation API</a>
    <li><a href="#ref-for-Exposed②">8.4.2. IDP Sign-out</a>
    <li><a href="#ref-for-Exposed③">8.5.1. Interceptors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-notallowederror">
   <a href="https://heycam.github.io/webidl/#notallowederror">https://heycam.github.io/webidl/#notallowederror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-notallowederror">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-promise">
   <a href="https://heycam.github.io/webidl/#idl-promise">https://heycam.github.io/webidl/#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise">8.3. The Revocation API</a>
    <li><a href="#ref-for-idl-promise①">8.4.2. IDP Sign-out</a>
    <li><a href="#ref-for-idl-promise②">8.5.1. Interceptors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-SecureContext">
   <a href="https://heycam.github.io/webidl/#SecureContext">https://heycam.github.io/webidl/#SecureContext</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-SecureContext">8.2. The Sign-in API</a>
    <li><a href="#ref-for-SecureContext①">8.3. The Revocation API</a>
    <li><a href="#ref-for-SecureContext②">8.4.2. IDP Sign-out</a>
    <li><a href="#ref-for-SecureContext③">8.5.1. Interceptors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-USVString">
   <a href="https://heycam.github.io/webidl/#idl-USVString">https://heycam.github.io/webidl/#idl-USVString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-USVString">8.2. The Sign-in API</a> <a href="#ref-for-idl-USVString①">(2)</a> <a href="#ref-for-idl-USVString②">(3)</a> <a href="#ref-for-idl-USVString③">(4)</a>
    <li><a href="#ref-for-idl-USVString④">8.3. The Revocation API</a>
    <li><a href="#ref-for-idl-USVString⑤">8.4.2. IDP Sign-out</a> <a href="#ref-for-idl-USVString⑥">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-sequence">
   <a href="https://heycam.github.io/webidl/#idl-sequence">https://heycam.github.io/webidl/#idl-sequence</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-sequence">8.2. The Sign-in API</a>
    <li><a href="#ref-for-idl-sequence①">8.4.2. IDP Sign-out</a>
    <li><a href="#ref-for-idl-sequence②">8.5.1. Interceptors</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[credential-management-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-credential">Credential</span>
     <li><span class="dfn-paneled" id="term-for-dictdef-credentialrequestoptions">CredentialRequestOptions</span>
     <li><span class="dfn-paneled" id="term-for-credentialscontainer">CredentialsContainer</span>
     <li><span class="dfn-paneled" id="term-for-federatedcredential">FederatedCredential</span>
     <li><span class="dfn-paneled" id="term-for-dictdef-federatedcredentialrequestoptions">FederatedCredentialRequestOptions</span>
     <li><span class="dfn-paneled" id="term-for-abstract-opdef-request-a-credential">Request a Credential</span>
     <li><span class="dfn-paneled" id="term-for-dom-credentialrequestoptions-federated">federated</span>
     <li><span class="dfn-paneled" id="term-for-dom-credentialscontainer-get">get()</span>
     <li><span class="dfn-paneled" id="term-for-dom-credentialrequestoptions-mediation">mediation</span>
     <li><span class="dfn-paneled" id="term-for-dom-federatedcredential-provider">provider</span>
     <li><span class="dfn-paneled" id="term-for-same-origin-with-its-ancestors">same-origin with its ancestors</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-environment-settings-object">environment settings object</span>
     <li><span class="dfn-paneled" id="term-for-concept-settings-object-origin">origin</span>
     <li><span class="dfn-paneled" id="term-for-relevant-settings-object">relevant settings object</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-map-exists">exist</span>
     <li><span class="dfn-paneled" id="term-for-list-size">size</span>
     <li><span class="dfn-paneled" id="term-for-user-agent">user agent</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-idl-DOMException">DOMException</span>
     <li><span class="dfn-paneled" id="term-for-idl-DOMString">DOMString</span>
     <li><span class="dfn-paneled" id="term-for-Exposed">Exposed</span>
     <li><span class="dfn-paneled" id="term-for-notallowederror">NotAllowedError</span>
     <li><span class="dfn-paneled" id="term-for-idl-promise">Promise</span>
     <li><span class="dfn-paneled" id="term-for-SecureContext">SecureContext</span>
     <li><span class="dfn-paneled" id="term-for-idl-USVString">USVString</span>
     <li><span class="dfn-paneled" id="term-for-idl-sequence">sequence</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-credential-management-1">[CREDENTIAL-MANAGEMENT-1]
   <dd>Mike West. <a href="https://www.w3.org/TR/credential-management-1/"><cite>Credential Management Level 1</cite></a>. 17 January 2019. WD. URL: <a href="https://www.w3.org/TR/credential-management-1/">https://www.w3.org/TR/credential-management-1/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Boris Zbarsky. <a href="https://heycam.github.io/webidl/"><cite>Web IDL</cite></a>. 15 December 2016. ED. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-front-channel-logout">[Front-Channel-Logout]
   <dd>M. Jones. <a href="https://openid.net/specs/openid-connect-frontchannel-1_0.html"><cite>Front-Channel Logout</cite></a>. URL: <a href="https://openid.net/specs/openid-connect-frontchannel-1_0.html">https://openid.net/specs/openid-connect-frontchannel-1_0.html</a>
   <dt id="biblio-identity-use-cases-in-browser-catalog">[Identity-Use-Cases-in-Browser-Catalog]
   <dd>V. Bertocci; G. Fletcher. <a href="https://datatracker.ietf.org/doc/html/draft-bertocci-identity-in-browser-00"><cite>Identity Use Cases in Browser Catalog</cite></a>. URL: <a href="https://datatracker.ietf.org/doc/html/draft-bertocci-identity-in-browser-00">https://datatracker.ietf.org/doc/html/draft-bertocci-identity-in-browser-00</a>
   <dt id="biblio-jwt">[JWT]
   <dd>M. Jones; J. Bradley; N. Sakimura. <a href="https://datatracker.ietf.org/doc/html/rfc7519"><cite>JWT</cite></a>. URL: <a href="https://datatracker.ietf.org/doc/html/rfc7519">https://datatracker.ietf.org/doc/html/rfc7519</a>
   <dt id="biblio-oauth">[OAuth]
   <dd>D. Hardt. <a href="https://datatracker.ietf.org/doc/html/rfc6749"><cite>OAuth</cite></a>. URL: <a href="https://datatracker.ietf.org/doc/html/rfc6749">https://datatracker.ietf.org/doc/html/rfc6749</a>
   <dt id="biblio-openid">[OpenID]
   <dd><a href="https://openid.net/developers/specs/"><cite>OpenID</cite></a>. URL: <a href="https://openid.net/developers/specs/">https://openid.net/developers/specs/</a>
   <dt id="biblio-saml">[SAML]
   <dd><a href="http://saml.xml.org/saml-specifications"><cite>SAML</cite></a>. URL: <a href="http://saml.xml.org/saml-specifications">http://saml.xml.org/saml-specifications</a>
   <dt id="biblio-security-origin-confusion">[Security-Origin-Confusion]
   <dd><a href="https://w3c.github.io/webappsec-credential-management/#security-origin-confusion"><cite>Security Origin Confusion</cite></a>. URL: <a href="https://w3c.github.io/webappsec-credential-management/#security-origin-confusion">https://w3c.github.io/webappsec-credential-management/#security-origin-confusion</a>
   <dt id="biblio-unsanctioned-web-tracking">[Unsanctioned-Web-Tracking]
   <dd>Mark Nottingham. <a href="https://www.w3.org/2001/tag/doc/unsanctioned-tracking/"><cite>Unsactioned Web Tracking</cite></a>. URL: <a href="https://www.w3.org/2001/tag/doc/unsanctioned-tracking/">https://www.w3.org/2001/tag/doc/unsanctioned-tracking/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>enum</c-> <a href="#enumdef-federatedcredentialapprovedby"><code><c- g>FederatedCredentialApprovedBy</c-></code></a> {
  <a href="#dom-federatedcredentialapprovedby-auto"><code><c- s>"auto"</c-></code></a>,
  <a href="#dom-federatedcredentialapprovedby-user"><code><c- s>"user"</c-></code></a>
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential"><c- g>FederatedCredential</c-></a> : <a data-link-type="idl-name" href="https://w3c.github.io/webappsec-credential-management/#credential"><c- n>Credential</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-federatedcredential-idtoken"><code><c- g>idToken</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name"><c- n>FederatedCredentialApprover</c-></a> <a data-readonly data-type="FederatedCredentialApprover" href="#dom-federatedcredential-approvedby"><code><c- g>approvedBy</c-></code></a>;
};

<c- b>partial</c-> <c- b>dictionary</c-> <a class="idl-code" data-link-type="dictionary" href="https://w3c.github.io/webappsec-credential-management/#dictdef-federatedcredentialrequestoptions"><c- g>FederatedCredentialRequestOptions</c-></a> {
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence"><c- b>sequence</c-></a>&lt;(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#dictdef-federatedidentityprovider"><c- n>FederatedIdentityProvider</c-></a>)> <a data-type="sequence<(DOMString or FederatedIdentityProvider)> " href="#dom-federatedcredentialrequestoptions-providers"><code><c- g>providers</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-federatedidentityprovider"><code><c- g>FederatedIdentityProvider</c-></code></a> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-federatedidentityprovider-url"><code><c- g>url</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-federatedidentityprovider-clientid"><code><c- g>clientId</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-federatedidentityprovider-nonce"><code><c- g>nonce</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential"><c- g>FederatedCredential</c-></a> : <a data-link-type="idl-name" href="https://w3c.github.io/webappsec-credential-management/#credential"><c- n>Credential</c-></a> {
  <c- b>static</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name"><c- n>void</c-></a>> <a href="#dom-federatedcredential-revoke"><code><c- g>revoke</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a href="#dom-federatedcredential-revoke-accountid-accountid"><code><c- g>accountId</c-></code></a>);
};

<c- b>dictionary</c-> <a href="#dictdef-webidlogoutrequest"><code><c- g>WebIdLogoutRequest</c-></code></a> {
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-webidlogoutrequest-endpoint"><code><c- g>endpoint</c-></code></a>;
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString " href="#dom-webidlogoutrequest-accountid"><code><c- g>accountId</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential"><c- g>FederatedCredential</c-></a> : <a data-link-type="idl-name" href="https://w3c.github.io/webappsec-credential-management/#credential"><c- n>Credential</c-></a> {
  <c- b>static</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name"><c- n>void</c-></a>> <a href="#dom-federatedcredential-logout"><code><c- g>logout</c-></code></a>(<c- b>optional</c-> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-webidlogoutrequest"><c- n>WebIdLogoutRequest</c-></a>> <a href="#dom-federatedcredential-logout-logout_requests-logout_requests"><code><c- g>logout_requests</c-></code></a> = []);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webappsec-credential-management/#federatedcredential"><c- g>FederatedCredential</c-></a> : <a data-link-type="idl-name" href="https://w3c.github.io/webappsec-credential-management/#credential"><c- n>Credential</c-></a> {
  <c- b>static</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name"><c- n>void</c-></a>> <a href="#dom-federatedcredential-registerinterceptor"><code><c- g>registerInterceptor</c-></code></a>(<a data-link-type="idl-name" href="#dictdef-federatedcredentialinterceptor"><c- n>FederatedCredentialInterceptor</c-></a> <a href="#dom-federatedcredential-registerinterceptor-interceptor-interceptor"><code><c- g>interceptor</c-></code></a>);
};

<c- b>dictionary</c-> <a href="#dictdef-federatedcredentialinterceptor"><code><c- g>FederatedCredentialInterceptor</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString " href="#dom-federatedcredentialinterceptor-url"><c- g>url</c-></a>;
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><c- b>DOMString</c-></a>> <a class="idl-code" data-link-type="dict-member" data-type="sequence<DOMString> " href="#dom-federatedcredentialinterceptor-params"><c- g>params</c-></a>;
};

</pre>
  <aside class="dfn-panel" data-for="relying-party">
   <b><a href="#relying-party">#relying-party</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relying-party①">2.1. Sign-up</a> <a href="#ref-for-relying-party②">(2)</a> <a href="#ref-for-relying-party③">(3)</a> <a href="#ref-for-relying-party④">(4)</a> <a href="#ref-for-relying-party⑤">(5)</a> <a href="#ref-for-relying-party⑥">(6)</a>
    <li><a href="#ref-for-relying-party⑦">2.2. Sign-in</a>
    <li><a href="#ref-for-relying-party⑧">2.2.1. Auto Sign-in</a> <a href="#ref-for-relying-party⑨">(2)</a> <a href="#ref-for-relying-party①⓪">(3)</a>
    <li><a href="#ref-for-relying-party①①">2.2.2. Explicit Sign-in</a> <a href="#ref-for-relying-party①②">(2)</a> <a href="#ref-for-relying-party①③">(3)</a> <a href="#ref-for-relying-party①④">(4)</a> <a href="#ref-for-relying-party①⑤">(5)</a> <a href="#ref-for-relying-party①⑥">(6)</a> <a href="#ref-for-relying-party①⑦">(7)</a>
    <li><a href="#ref-for-relying-party①⑧">2.3. Sign-out</a>
    <li><a href="#ref-for-relying-party①⑨">2.3.1. RP Sign-out</a> <a href="#ref-for-relying-party②⓪">(2)</a> <a href="#ref-for-relying-party②①">(3)</a>
    <li><a href="#ref-for-relying-party②②">2.3.2. IDP Sign-out</a> <a href="#ref-for-relying-party②③">(2)</a> <a href="#ref-for-relying-party②④">(3)</a> <a href="#ref-for-relying-party②⑤">(4)</a>
    <li><a href="#ref-for-relying-party②⑥">2.4. Revocation</a>
    <li><a href="#ref-for-relying-party②⑦">2.4.1. IDP Revocation</a> <a href="#ref-for-relying-party②⑧">(2)</a>
    <li><a href="#ref-for-relying-party②⑨">2.4.2. RP Revocation</a> <a href="#ref-for-relying-party③⓪">(2)</a> <a href="#ref-for-relying-party③①">(3)</a>
    <li><a href="#ref-for-relying-party③②">2.5. Access</a> <a href="#ref-for-relying-party③③">(2)</a> <a href="#ref-for-relying-party③④">(3)</a> <a href="#ref-for-relying-party③⑤">(4)</a>
    <li><a href="#ref-for-relying-party③⑥">8.2. The Sign-in API</a> <a href="#ref-for-relying-party③⑦">(2)</a> <a href="#ref-for-relying-party③⑧">(3)</a> <a href="#ref-for-relying-party③⑨">(4)</a> <a href="#ref-for-relying-party④⓪">(5)</a> <a href="#ref-for-relying-party④①">(6)</a>
    <li><a href="#ref-for-relying-party④②">8.3. The Revocation API</a> <a href="#ref-for-relying-party④③">(2)</a> <a href="#ref-for-relying-party④④">(3)</a>
    <li><a href="#ref-for-relying-party④⑤">8.4.1. RP Sign-out</a> <a href="#ref-for-relying-party④⑥">(2)</a>
    <li><a href="#ref-for-relying-party④⑦">8.4.2. IDP Sign-out</a> <a href="#ref-for-relying-party④⑧">(2)</a> <a href="#ref-for-relying-party④⑨">(3)</a>
    <li><a href="#ref-for-relying-party⑤⓪">10.1.1. Principals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rp">
   <b><a href="#rp">#rp</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rp">3. Examples</a> <a href="#ref-for-rp①">(2)</a> <a href="#ref-for-rp②">(3)</a>
    <li><a href="#ref-for-rp③">5. High Level Design</a>
    <li><a href="#ref-for-rp④">6.3. Client Metadata</a> <a href="#ref-for-rp⑤">(2)</a> <a href="#ref-for-rp⑥">(3)</a>
    <li><a href="#ref-for-rp⑦">6.4. ID Token</a> <a href="#ref-for-rp⑧">(2)</a>
    <li><a href="#ref-for-rp⑨">7. The Relying Party API</a>
    <li><a href="#ref-for-rp①⓪">7.1. Logout</a> <a href="#ref-for-rp①①">(2)</a>
    <li><a href="#ref-for-rp①②">8. The Browser API</a> <a href="#ref-for-rp①③">(2)</a> <a href="#ref-for-rp①④">(3)</a> <a href="#ref-for-rp①⑤">(4)</a> <a href="#ref-for-rp①⑥">(5)</a>
    <li><a href="#ref-for-rp①⑦">8.1. The State Machine</a>
    <li><a href="#ref-for-rp①⑧">8.4.2. IDP Sign-out</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="identity-provider">
   <b><a href="#identity-provider">#identity-provider</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-identity-provider①">2.1. Sign-up</a> <a href="#ref-for-identity-provider②">(2)</a> <a href="#ref-for-identity-provider③">(3)</a> <a href="#ref-for-identity-provider④">(4)</a>
    <li><a href="#ref-for-identity-provider⑤">2.2.1. Auto Sign-in</a> <a href="#ref-for-identity-provider⑥">(2)</a> <a href="#ref-for-identity-provider⑦">(3)</a>
    <li><a href="#ref-for-identity-provider⑧">2.2.2. Explicit Sign-in</a> <a href="#ref-for-identity-provider⑨">(2)</a> <a href="#ref-for-identity-provider①⓪">(3)</a> <a href="#ref-for-identity-provider①①">(4)</a>
    <li><a href="#ref-for-identity-provider①②">2.3.2. IDP Sign-out</a> <a href="#ref-for-identity-provider①③">(2)</a>
    <li><a href="#ref-for-identity-provider①④">2.4.1. IDP Revocation</a> <a href="#ref-for-identity-provider①⑤">(2)</a>
    <li><a href="#ref-for-identity-provider①⑥">2.4.2. RP Revocation</a>
    <li><a href="#ref-for-identity-provider①⑦">2.5. Access</a> <a href="#ref-for-identity-provider①⑧">(2)</a> <a href="#ref-for-identity-provider①⑨">(3)</a> <a href="#ref-for-identity-provider②⓪">(4)</a>
    <li><a href="#ref-for-identity-provider②①">8.2. The Sign-in API</a> <a href="#ref-for-identity-provider②②">(2)</a> <a href="#ref-for-identity-provider②③">(3)</a> <a href="#ref-for-identity-provider②④">(4)</a> <a href="#ref-for-identity-provider②⑤">(5)</a> <a href="#ref-for-identity-provider②⑥">(6)</a> <a href="#ref-for-identity-provider②⑦">(7)</a> <a href="#ref-for-identity-provider②⑧">(8)</a>
    <li><a href="#ref-for-identity-provider②⑨">8.3. The Revocation API</a>
    <li><a href="#ref-for-identity-provider③⓪">8.4.2. IDP Sign-out</a> <a href="#ref-for-identity-provider③①">(2)</a>
    <li><a href="#ref-for-identity-provider③②">10.1.1. Principals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="idp">
   <b><a href="#idp">#idp</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idp">3. Examples</a>
    <li><a href="#ref-for-idp①">5. High Level Design</a> <a href="#ref-for-idp②">(2)</a> <a href="#ref-for-idp③">(3)</a>
    <li><a href="#ref-for-idp④">6. The Identity Provider API</a>
    <li><a href="#ref-for-idp⑤">6.1. Discovery</a> <a href="#ref-for-idp⑥">(2)</a>
    <li><a href="#ref-for-idp⑦">6.2. Accounts List</a>
    <li><a href="#ref-for-idp⑧">7.1. Logout</a> <a href="#ref-for-idp⑨">(2)</a>
    <li><a href="#ref-for-idp①⓪">8. The Browser API</a> <a href="#ref-for-idp①①">(2)</a> <a href="#ref-for-idp①②">(3)</a>
    <li><a href="#ref-for-idp①③">8.1. The State Machine</a>
    <li><a href="#ref-for-idp①④">8.4.2. IDP Sign-out</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="session">
   <b><a href="#session">#session</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-session">2.1. Sign-up</a>
    <li><a href="#ref-for-session①">2.2. Sign-in</a>
    <li><a href="#ref-for-session②">2.2.1. Auto Sign-in</a>
    <li><a href="#ref-for-session③">2.2.2. Explicit Sign-in</a>
    <li><a href="#ref-for-session④">2.3. Sign-out</a>
    <li><a href="#ref-for-session⑤">2.3.2. IDP Sign-out</a>
    <li><a href="#ref-for-session⑥">2.5. Access</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="account">
   <b><a href="#account">#account</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-account">2.1. Sign-up</a>
    <li><a href="#ref-for-account①">2.2. Sign-in</a>
    <li><a href="#ref-for-account②">2.2.1. Auto Sign-in</a> <a href="#ref-for-account③">(2)</a>
    <li><a href="#ref-for-account④">2.2.2. Explicit Sign-in</a>
    <li><a href="#ref-for-account⑤">2.3. Sign-out</a>
    <li><a href="#ref-for-account⑥">2.5. Access</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="id-token">
   <b><a href="#id-token">#id-token</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-id-token">3. Examples</a>
    <li><a href="#ref-for-id-token①">6.4. ID Token</a>
    <li><a href="#ref-for-id-token②">8.2. The Sign-in API</a> <a href="#ref-for-id-token③">(2)</a> <a href="#ref-for-id-token④">(3)</a> <a href="#ref-for-id-token⑤">(4)</a> <a href="#ref-for-id-token⑥">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="high-level-api">
   <b><a href="#high-level-api">#high-level-api</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-high-level-api①">1. Introduction</a>
    <li><a href="#ref-for-high-level-api②">4. Terminology</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="low-level-api">
   <b><a href="#low-level-api">#low-level-api</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-low-level-api">1. Introduction</a>
    <li><a href="#ref-for-low-level-api①">4. Terminology</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="registered">
   <b><a href="#registered">#registered</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-registered">8.1. The State Machine</a>
    <li><a href="#ref-for-registered①">8.2. The Sign-in API</a> <a href="#ref-for-registered②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="unregistered">
   <b><a href="#unregistered">#unregistered</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-unregistered">8.1. The State Machine</a>
    <li><a href="#ref-for-unregistered①">8.2. The Sign-in API</a> <a href="#ref-for-unregistered②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="logged-in">
   <b><a href="#logged-in">#logged-in</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-logged-in">8.1. The State Machine</a>
    <li><a href="#ref-for-logged-in①">8.2. The Sign-in API</a> <a href="#ref-for-logged-in②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="logged-out">
   <b><a href="#logged-out">#logged-out</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-logged-out">8.1. The State Machine</a>
    <li><a href="#ref-for-logged-out①">8.2. The Sign-in API</a> <a href="#ref-for-logged-out②">(2)</a> <a href="#ref-for-logged-out③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="out-of-band">
   <b><a href="#out-of-band">#out-of-band</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-out-of-band">7.1. Logout</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-wellknown-accounts_endpoint">
   <b><a href="#dom-wellknown-accounts_endpoint">#dom-wellknown-accounts_endpoint</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-wellknown-accounts_endpoint">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-wellknown-client_id_metadata_endpoint">
   <b><a href="#dom-wellknown-client_id_metadata_endpoint">#dom-wellknown-client_id_metadata_endpoint</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-wellknown-client_id_metadata_endpoint">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-wellknown-idtoken_endpoint">
   <b><a href="#dom-wellknown-idtoken_endpoint">#dom-wellknown-idtoken_endpoint</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-wellknown-idtoken_endpoint">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="account-json">
   <b><a href="#account-json">#account-json</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-account-json">6.2. Accounts List</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-accounts_endpoint_response_accounts-account_id">
   <b><a href="#dom-accounts_endpoint_response_accounts-account_id">#dom-accounts_endpoint_response_accounts-account_id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-accounts_endpoint_response_accounts-account_id">8.2. The Sign-in API</a> <a href="#ref-for-dom-accounts_endpoint_response_accounts-account_id①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client_id_metadata_endpont_response-privacy_policy_url">
   <b><a href="#dom-client_id_metadata_endpont_response-privacy_policy_url">#dom-client_id_metadata_endpont_response-privacy_policy_url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-client_id_metadata_endpont_response-privacy_policy_url">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client_id_metadata_endpont_response-terms_of_service_url">
   <b><a href="#dom-client_id_metadata_endpont_response-terms_of_service_url">#dom-client_id_metadata_endpont_response-terms_of_service_url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-client_id_metadata_endpont_response-terms_of_service_url">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-idtoken_endpoint_request-account_id">
   <b><a href="#dom-idtoken_endpoint_request-account_id">#dom-idtoken_endpoint_request-account_id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-idtoken_endpoint_request-account_id">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-idtoken_endpoint_request-request">
   <b><a href="#dom-idtoken_endpoint_request-request">#dom-idtoken_endpoint_request-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-idtoken_endpoint_request-request">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rp-request">
   <b><a href="#rp-request">#rp-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rp-request">6.4. ID Token</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-idtoken_endpoint_request_request-client_id">
   <b><a href="#dom-idtoken_endpoint_request_request-client_id">#dom-idtoken_endpoint_request_request-client_id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-idtoken_endpoint_request_request-client_id">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-idtoken_endpoint_request_request-nonce">
   <b><a href="#dom-idtoken_endpoint_request_request-nonce">#dom-idtoken_endpoint_request_request-nonce</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-idtoken_endpoint_request_request-nonce">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-statemachine-account-state">
   <b><a href="#dom-statemachine-account-state">#dom-statemachine-account-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-statemachine-account-state">8.2. The Sign-in API</a> <a href="#ref-for-dom-statemachine-account-state①">(2)</a> <a href="#ref-for-dom-statemachine-account-state②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-statemachine-session-state">
   <b><a href="#dom-statemachine-session-state">#dom-statemachine-session-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-statemachine-session-state">8.2. The Sign-in API</a> <a href="#ref-for-dom-statemachine-session-state①">(2)</a> <a href="#ref-for-dom-statemachine-session-state②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-federatedcredential-idtoken">
   <b><a href="#dom-federatedcredential-idtoken">#dom-federatedcredential-idtoken</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-federatedcredential-idtoken">8.2. The Sign-in API</a> <a href="#ref-for-dom-federatedcredential-idtoken①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-federatedcredential-approvedby">
   <b><a href="#dom-federatedcredential-approvedby">#dom-federatedcredential-approvedby</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-federatedcredential-approvedby">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-federatedcredentialrequestoptions-providers">
   <b><a href="#dom-federatedcredentialrequestoptions-providers">#dom-federatedcredentialrequestoptions-providers</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-federatedcredentialrequestoptions-providers">8.2. The Sign-in API</a> <a href="#ref-for-dom-federatedcredentialrequestoptions-providers①">(2)</a> <a href="#ref-for-dom-federatedcredentialrequestoptions-providers②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-federatedidentityprovider">
   <b><a href="#dictdef-federatedidentityprovider">#dictdef-federatedidentityprovider</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-federatedidentityprovider">8.2. The Sign-in API</a> <a href="#ref-for-dictdef-federatedidentityprovider①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-federatedidentityprovider-url">
   <b><a href="#dom-federatedidentityprovider-url">#dom-federatedidentityprovider-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-federatedidentityprovider-url">8.2. The Sign-in API</a> <a href="#ref-for-dom-federatedidentityprovider-url①">(2)</a> <a href="#ref-for-dom-federatedidentityprovider-url②">(3)</a> <a href="#ref-for-dom-federatedidentityprovider-url③">(4)</a> <a href="#ref-for-dom-federatedidentityprovider-url④">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-federatedidentityprovider-clientid">
   <b><a href="#dom-federatedidentityprovider-clientid">#dom-federatedidentityprovider-clientid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-federatedidentityprovider-clientid">8.2. The Sign-in API</a> <a href="#ref-for-dom-federatedidentityprovider-clientid①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-federatedidentityprovider-nonce">
   <b><a href="#dom-federatedidentityprovider-nonce">#dom-federatedidentityprovider-nonce</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-federatedidentityprovider-nonce">8.2. The Sign-in API</a> <a href="#ref-for-dom-federatedidentityprovider-nonce①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="sign-up">
   <b><a href="#sign-up">#sign-up</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sign-up">2.4.2. RP Revocation</a>
    <li><a href="#ref-for-sign-up">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="select-an-account">
   <b><a href="#select-an-account">#select-an-account</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-select-an-account">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="sign-in①">
   <b><a href="#sign-in①">#sign-in①</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sign-in①">8.2. The Sign-in API</a> <a href="#ref-for-sign-in①①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="auto-sign-in">
   <b><a href="#auto-sign-in">#auto-sign-in</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-auto-sign-in">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="explicit-sign-in">
   <b><a href="#explicit-sign-in">#explicit-sign-in</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-explicit-sign-in">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="fetch-the-well-known">
   <b><a href="#fetch-the-well-known">#fetch-the-well-known</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-fetch-the-well-known">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="fetch-the-accounts-list">
   <b><a href="#fetch-the-accounts-list">#fetch-the-accounts-list</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-fetch-the-accounts-list">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="privacy-policy">
   <b><a href="#privacy-policy">#privacy-policy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-privacy-policy">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="terms-of-service">
   <b><a href="#terms-of-service">#terms-of-service</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-terms-of-service">8.2. The Sign-in API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-webidlogoutrequest">
   <b><a href="#dictdef-webidlogoutrequest">#dictdef-webidlogoutrequest</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-webidlogoutrequest">8.4.2. IDP Sign-out</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-federatedcredentialinterceptor">
   <b><a href="#dictdef-federatedcredentialinterceptor">#dictdef-federatedcredentialinterceptor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-federatedcredentialinterceptor">8.5.1. Interceptors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-federatedcredentialinterceptor-url">
   <b><a href="#dom-federatedcredentialinterceptor-url">#dom-federatedcredentialinterceptor-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-federatedcredentialinterceptor-url">8.5.1. Interceptors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-federatedcredentialinterceptor-params">
   <b><a href="#dom-federatedcredentialinterceptor-params">#dom-federatedcredentialinterceptor-params</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-federatedcredentialinterceptor-params">8.5.1. Interceptors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rp1">
   <b><a href="#rp1">#rp1</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rp1">10.1.3.1. Directed identifiers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rp2">
   <b><a href="#rp2">#rp2</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rp2">10.1.3.2. Browser-enforced consent</a>
    <li><a href="#ref-for-rp2①">10.1.3.6. Identity Provider has a relationship with the RP</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rp3">
   <b><a href="#rp3">#rp3</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rp3">10.1.3.6. Identity Provider has a relationship with the RP</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="idp1">
   <b><a href="#idp1">#idp1</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idp1">10.1.2.3.2. (COL2) RP sharing user-identifying information with the IDP</a>
    <li><a href="#ref-for-idp1①">10.1.3.2. Browser-enforced consent</a>
    <li><a href="#ref-for-idp1②">10.1.3.5. Hiding the RP from the IDP</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="idp2">
   <b><a href="#idp2">#idp2</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idp2">10.1.3.3. Identity Provider policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="col1">
   <b><a href="#col1">#col1</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-col1">10.1.3.3. Identity Provider policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="col2">
   <b><a href="#col2">#col2</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-col2">10.1.3.2. Browser-enforced consent</a>
    <li><a href="#ref-for-col2①">10.1.3.5. Hiding the RP from the IDP</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>